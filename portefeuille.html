<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portefeuille Digital Intelligent - Togo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --primary-dark: #2980b9;
            --secondary-color: #2ecc71;
            --secondary-dark: #27ae60;
            --expense-color: #e74c3c;
            --debt-color: #f39c12;
            --pocket-money-color: #9b59b6;
            --loaded-money-color: #1abc9c;
            --background-color: #f8fafc;
            --card-color: #ffffff;
            --text-color: #2d3748;
            --text-light: #718096;
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            --box-shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.1);
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--gradient-primary);
            padding: 20px;
        }

        .auth-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            width: 100%;
            max-width: 450px;
            box-shadow: var(--box-shadow-lg);
            text-align: center;
        }

        .auth-logo {
            margin-bottom: 30px;
        }

        .auth-logo i {
            font-size: 3.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
        }

        .auth-logo h1 {
            font-size: 1.8rem;
            color: var(--text-color);
            font-weight: 700;
        }

        .auth-form {
            text-align: left;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.95rem;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .btn-success {
            background: var(--gradient-success);
        }

        .btn-danger {
            background: var(--gradient-secondary);
        }

        .app-container {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo i {
            font-size: 2.5rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .logout-btn {
            background: var(--gradient-secondary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            transition: all 0.3s ease;
            border: 1px solid #f1f5f9;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-lg);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }

        .balance-card .card-icon { background: var(--gradient-success); }
        .expenses-card .card-icon { background: var(--gradient-secondary); }
        .debts-card .card-icon { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); }
        .pocket-money-card .card-icon { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
        .loaded-money-card .card-icon { background: linear-gradient(135deg, #5ee7df 0%, #b490ca 100%); }

        .card-content h3 {
            font-size: 0.95rem;
            color: var(--text-light);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .card-content .amount {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .tabs-container {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            margin-bottom: 25px;
            box-shadow: var(--box-shadow);
        }

        .tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #e2e8f0;
        }

        .tab {
            flex: 1;
            padding: 18px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-light);
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: rgba(52, 152, 219, 0.05);
        }

        .tab:hover:not(.active) {
            color: var(--primary-dark);
            background: rgba(52, 152, 219, 0.02);
        }

        .content-section {
            display: none;
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f1f5f9;
        }

        .section-header h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-header h2 i {
            color: var(--primary-color);
        }

        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 200px;
        }

        .filter-group label {
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .transaction-list {
            margin-top: 25px;
        }

        .transaction-list h3 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: var(--text-color);
            font-weight: 600;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.3s ease;
        }

        .transaction-item:hover {
            background: #f8fafc;
            border-radius: var(--border-radius-sm);
        }

        .transaction-item:last-child {
            border-bottom: none;
        }

        .transaction-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .transaction-name {
            font-weight: 600;
            font-size: 1.05rem;
        }

        .transaction-date {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .expense-amount { color: var(--expense-color); }
        .income-amount { color: var(--secondary-color); }
        .debt-amount { color: var(--debt-color); }
        .pocket-money-amount { color: var(--pocket-money-color); }
        .loaded-money-amount { color: var(--loaded-money-color); }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-btn {
            color: #e74c3c;
        }

        .delete-btn:hover {
            background: rgba(231, 76, 60, 0.1);
        }

        .edit-btn {
            color: var(--primary-color);
        }

        .edit-btn:hover {
            background: rgba(52, 152, 219, 0.1);
        }

        .chart-container {
            height: 350px;
            margin-top: 25px;
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
        }

        .month-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 25px;
            color: white;
            box-shadow: var(--box-shadow);
        }

        .month-summary h3 {
            margin-bottom: 20px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .summary-item:last-child {
            border-bottom: none;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .comparison-section {
            margin-top: 30px;
        }

        .comparison-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            text-align: center;
            transition: all 0.3s ease;
        }

        .comparison-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--box-shadow-lg);
        }

        .comparison-card h4 {
            margin-bottom: 15px;
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 600;
        }

        .comparison-card .amount {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .positive-change {
            color: var(--secondary-color);
            font-weight: 600;
        }

        .negative-change {
            color: var(--expense-color);
            font-weight: 600;
        }

        .notification {
            position: fixed;
            top: 25px;
            right: 25px;
            padding: 18px 24px;
            background: var(--secondary-color);
            color: white;
            border-radius: var(--border-radius-sm);
            box-shadow: var(--box-shadow-lg);
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            max-width: 400px;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.error {
            background: var(--expense-color);
        }

        .notification.warning {
            background: var(--debt-color);
        }

        .report-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        footer {
            text-align: center;
            padding: 30px;
            margin-top: 40px;
            color: var(--text-light);
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }

            .filters {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .app-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .report-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .auth-card {
                padding: 30px 20px;
            }

            .card {
                padding: 20px;
            }

            .content-section {
                padding: 20px;
            }

            .transaction-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .action-buttons {
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <!-- Section d'authentification -->
    <div class="auth-container" id="auth-container">
        <div class="auth-card">
            <div class="auth-logo">
                <i class="fas fa-wallet"></i>
                <h1>Portefeuille Digital</h1>
            </div>
            <form class="auth-form" id="login-form">
                <div class="form-group">
                    <label for="username">Identifiant</label>
                    <input type="text" id="username" class="form-control" placeholder="Entrez votre identifiant" required>
                </div>
                <div class="form-group">
                    <label for="password">Mot de passe</label>
                    <input type="password" id="password" class="form-control" placeholder="Entrez votre mot de passe" required>
                </div>
                <button type="submit" class="btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Se connecter
                </button>
            </form>
        </div>
    </div>

    <!-- Application principale -->
    <div class="app-container" id="app-container">
        <!-- En-tête de l'application -->
        <header class="app-header">
            <div class="logo">
                <i class="fas fa-wallet"></i>
                <h1>Portefeuille Digital Intelligent</h1>
            </div>
            <div class="user-info">
                <div class="user-avatar">
                    <span>K</span>
                </div>
                <div>
                    <div style="font-weight: 600;">KOLA</div>
                    <div style="font-size: 0.9rem; color: var(--text-light);">Utilisateur</div>
                </div>
                <button class="logout-btn" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    Déconnexion
                </button>
            </div>
        </header>

        <!-- Tableau de bord -->
        <div class="dashboard">
            <div class="card balance-card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="card-content">
                        <h3>Solde Total</h3>
                        <div class="amount" id="total-balance">0 FCFA</div>
                    </div>
                </div>
            </div>
            <div class="card expenses-card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="card-content">
                        <h3>Dépenses du Mois</h3>
                        <div class="amount" id="total-expenses">0 FCFA</div>
                    </div>
                </div>
            </div>
            <div class="card debts-card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-hand-holding-usd"></i>
                    </div>
                    <div class="card-content">
                        <h3>Dettes</h3>
                        <div class="amount" id="total-debts">0 FCFA</div>
                    </div>
                </div>
            </div>
            <div class="card pocket-money-card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="card-content">
                        <h3>Argent de Poche</h3>
                        <div class="amount" id="total-pocket-money">0 FCFA</div>
                    </div>
                </div>
            </div>
            <div class="card loaded-money-card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <div class="card-content">
                        <h3>Argent Chargé</h3>
                        <div class="amount" id="total-loaded-money">0 FCFA</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation par onglets -->
        <div class="tabs-container">
            <div class="tabs">
                <div class="tab active" data-tab="loaded-money">Argent Chargé</div>
                <div class="tab" data-tab="expenses">Dépenses</div>
                <div class="tab" data-tab="debts">Dettes</div>
                <div class="tab" data-tab="pocket-money">Argent de Poche</div>
                <div class="tab" data-tab="analytics">Analyses</div>
                <div class="tab" data-tab="reports">Rapports</div>
            </div>
        </div>

        <!-- Contenu des onglets -->
        <div class="content-section active" id="loaded-money-section">
            <div class="section-header">
                <h2><i class="fas fa-credit-card"></i> Gestion de l'Argent Chargé</h2>
            </div>
            
            <div class="month-summary">
                <h3><i class="fas fa-chart-bar"></i> Résumé du Mois en Cours: <span id="current-month-display"></span></h3>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span>Argent chargé ce mois:</span>
                        <span class="loaded-money-amount" id="summary-loaded">0 FCFA</span>
                    </div>
                    <div class="summary-item">
                        <span>Dépenses ce mois:</span>
                        <span class="expense-amount" id="summary-expenses">0 FCFA</span>
                    </div>
                    <div class="summary-item">
                        <span>Dettes ce mois:</span>
                        <span class="debt-amount" id="summary-debts">0 FCFA</span>
                    </div>
                    <div class="summary-item">
                        <span>Argent de poche ce mois:</span>
                        <span class="pocket-money-amount" id="summary-pocket-money">0 FCFA</span>
                    </div>
                    <div class="summary-item">
                        <span>Solde restant:</span>
                        <span class="income-amount" id="summary-balance">0 FCFA</span>
                    </div>
                </div>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label for="loaded-money-month-filter">Filtrer par mois</label>
                    <select id="loaded-money-month-filter" class="form-control">
                        <option value="all">Tous les mois</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="loaded-money-source-filter">Filtrer par source</label>
                    <select id="loaded-money-source-filter" class="form-control">
                        <option value="all">Toutes les sources</option>
                        <option value="salaire">Salaire</option>
                        <option value="business">Business</option>
                        <option value="cadeau">Cadeau</option>
                        <option value="autres">Autres</option>
                    </select>
                </div>
            </div>
            
            <form id="loaded-money-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="loaded-money-amount">Montant chargé (FCFA)</label>
                        <input type="number" id="loaded-money-amount" class="form-control" min="0" step="100" placeholder="Ex: 100000" required>
                    </div>
                    <div class="form-group">
                        <label for="loaded-money-source">Source</label>
                        <select id="loaded-money-source" class="form-control" required>
                            <option value="">Sélectionnez une source</option>
                            <option value="salaire">Salaire</option>
                            <option value="business">Business</option>
                            <option value="cadeau">Cadeau</option>
                            <option value="autres">Autres</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="loaded-money-date">Date</label>
                        <input type="date" id="loaded-money-date" class="form-control" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="loaded-money-description">Description (optionnel)</label>
                    <input type="text" id="loaded-money-description" class="form-control" placeholder="Ex: Salaire du mois de novembre">
                </div>
                <button type="submit" class="btn">
                    <i class="fas fa-plus"></i>
                    Ajouter Argent Chargé
                </button>
            </form>

            <div class="transaction-list">
                <h3>Historique de l'Argent Chargé</h3>
                <div id="loaded-money-list">
                    <div class="empty-state">
                        <i class="fas fa-money-bill-wave"></i>
                        <p>Aucun argent chargé pour le moment</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section" id="expenses-section">
            <div class="section-header">
                <h2><i class="fas fa-shopping-cart"></i> Gestion des Dépenses</h2>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label for="expense-month-filter">Filtrer par mois</label>
                    <select id="expense-month-filter" class="form-control">
                        <option value="all">Tous les mois</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="expense-category-filter">Filtrer par catégorie</label>
                    <select id="expense-category-filter" class="form-control">
                        <option value="all">Toutes les catégories</option>
                        <option value="alimentation">Alimentation</option>
                        <option value="transport">Transport</option>
                        <option value="logement">Logement</option>
                        <option value="loisirs">Loisirs</option>
                        <option value="sante">Santé</option>
                        <option value="autres">Autres</option>
                    </select>
                </div>
            </div>
            
            <form id="expense-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="expense-name">Nom de la dépense</label>
                        <input type="text" id="expense-name" class="form-control" placeholder="Ex: Courses alimentaires" required>
                    </div>
                    <div class="form-group">
                        <label for="expense-amount">Montant (FCFA)</label>
                        <input type="number" id="expense-amount" class="form-control" min="0" step="100" placeholder="Ex: 30000" required>
                    </div>
                    <div class="form-group">
                        <label for="expense-category">Catégorie</label>
                        <select id="expense-category" class="form-control" required>
                            <option value="">Sélectionnez une catégorie</option>
                            <option value="alimentation">Alimentation</option>
                            <option value="transport">Transport</option>
                            <option value="logement">Logement</option>
                            <option value="loisirs">Loisirs</option>
                            <option value="sante">Santé</option>
                            <option value="autres">Autres</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="expense-date">Date</label>
                        <input type="date" id="expense-date" class="form-control" required>
                    </div>
                </div>
                <button type="submit" class="btn">
                    <i class="fas fa-plus"></i>
                    Ajouter Dépense
                </button>
            </form>

            <div class="transaction-list">
                <h3>Historique des Dépenses</h3>
                <div id="expenses-list">
                    <div class="empty-state">
                        <i class="fas fa-shopping-cart"></i>
                        <p>Aucune dépense enregistrée</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section" id="debts-section">
            <div class="section-header">
                <h2><i class="fas fa-hand-holding-usd"></i> Gestion des Dettes</h2>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label for="debt-month-filter">Filtrer par mois</label>
                    <select id="debt-month-filter" class="form-control">
                        <option value="all">Tous les mois</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="debt-type-filter">Filtrer par type</label>
                    <select id="debt-type-filter" class="form-control">
                        <option value="all">Tous les types</option>
                        <option value="owe">Je dois</option>
                        <option value="owed">On me doit</option>
                    </select>
                </div>
            </div>
            
            <form id="debt-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="debt-name">Nom de la dette</label>
                        <input type="text" id="debt-name" class="form-control" placeholder="Ex: Prêt étudiant" required>
                    </div>
                    <div class="form-group">
                        <label for="debt-amount">Montant (FCFA)</label>
                        <input type="number" id="debt-amount" class="form-control" min="0" step="100" placeholder="Ex: 50000" required>
                    </div>
                    <div class="form-group">
                        <label for="debt-type">Type</label>
                        <select id="debt-type" class="form-control" required>
                            <option value="">Sélectionnez un type</option>
                            <option value="owe">Je dois de l'argent</option>
                            <option value="owed">On me doit de l'argent</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="debt-person">Personne concernée</label>
                        <input type="text" id="debt-person" class="form-control" placeholder="Ex: Jean Dupont">
                    </div>
                    <div class="form-group">
                        <label for="debt-due-date">Date d'échéance</label>
                        <input type="date" id="debt-due-date" class="form-control">
                    </div>
                </div>
                <button type="submit" class="btn">
                    <i class="fas fa-plus"></i>
                    Ajouter Dette
                </button>
            </form>

            <div class="transaction-list">
                <h3>Liste des Dettes</h3>
                <div id="debts-list">
                    <div class="empty-state">
                        <i class="fas fa-hand-holding-usd"></i>
                        <p>Aucune dette enregistrée</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section" id="pocket-money-section">
            <div class="section-header">
                <h2><i class="fas fa-coins"></i> Gestion de l'Argent de Poche</h2>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label for="pocket-money-month-filter">Filtrer par mois</label>
                    <select id="pocket-money-month-filter" class="form-control">
                        <option value="all">Tous les mois</option>
                    </select>
                </div>
            </div>
            
            <form id="pocket-money-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="pocket-money-amount">Montant (FCFA)</label>
                        <input type="number" id="pocket-money-amount" class="form-control" min="0" step="100" placeholder="Ex: 5000" required>
                    </div>
                    <div class="form-group">
                        <label for="pocket-money-source">Source</label>
                        <input type="text" id="pocket-money-source" class="form-control" placeholder="Ex: Cadeau d'anniversaire">
                    </div>
                    <div class="form-group">
                        <label for="pocket-money-date">Date</label>
                        <input type="date" id="pocket-money-date" class="form-control" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-plus"></i>
                    Ajouter Argent
                </button>
            </form>

            <div class="transaction-list">
                <h3>Historique de l'Argent de Poche</h3>
                <div id="pocket-money-list">
                    <div class="empty-state">
                        <i class="fas fa-coins"></i>
                        <p>Aucun argent de poche enregistré</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section" id="analytics-section">
            <div class="section-header">
                <h2><i class="fas fa-chart-pie"></i> Analyses et Statistiques</h2>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label for="analytics-month-filter">Analyser le mois</label>
                    <select id="analytics-month-filter" class="form-control">
                        <!-- Les options seront ajoutées dynamiquement -->
                    </select>
                </div>
                <div class="filter-group">
                    <label for="comparison-month-filter">Comparer avec</label>
                    <select id="comparison-month-filter" class="form-control">
                        <option value="none">Aucune comparaison</option>
                        <!-- Les options seront ajoutées dynamiquement -->
                    </select>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="expenses-chart"></canvas>
            </div>
            
            <div class="comparison-section" id="comparison-section" style="display: none;">
                <h3>Comparaison Mensuelle</h3>
                <div class="comparison-cards">
                    <div class="comparison-card">
                        <h4>Argent Chargé</h4>
                        <div class="amount" id="comparison-loaded-money">0 FCFA</div>
                        <div id="loaded-money-change">-</div>
                    </div>
                    <div class="comparison-card">
                        <h4>Dépenses</h4>
                        <div class="amount" id="comparison-expenses">0 FCFA</div>
                        <div id="expenses-change">-</div>
                    </div>
                    <div class="comparison-card">
                        <h4>Dettes (je dois)</h4>
                        <div class="amount" id="comparison-debts">0 FCFA</div>
                        <div id="debts-change">-</div>
                    </div>
                    <div class="comparison-card">
                        <h4>Argent de poche</h4>
                        <div class="amount" id="comparison-pocket-money">0 FCFA</div>
                        <div id="pocket-money-change">-</div>
                    </div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 30px;">
                <div class="card">
                    <h3>Dépense la plus élevée</h3>
                    <div class="amount expense-amount" id="highest-expense">0 FCFA</div>
                    <p id="highest-expense-name">-</p>
                </div>
                <div class="card">
                    <h3>Moyenne des dépenses/jour</h3>
                    <div class="amount expense-amount" id="average-expense">0 FCFA</div>
                </div>
                <div class="card">
                    <h3>Catégorie principale</h3>
                    <p id="main-category">-</p>
                    <div class="amount" id="main-category-percent">0%</div>
                </div>
            </div>
        </div>

        <div class="content-section" id="reports-section">
            <div class="section-header">
                <h2><i class="fas fa-file-alt"></i> Rapports Automatiques</h2>
            </div>
            
            <div class="report-actions">
                <button class="btn btn-info" id="generate-report">
                    <i class="fas fa-chart-line"></i> Générer Rapport des 6 Derniers Mois
                </button>
                <button class="btn btn-success" id="export-report">
                    <i class="fas fa-download"></i> Exporter en PDF
                </button>
            </div>
            
            <div id="report-content">
                <div class="empty-state">
                    <i class="fas fa-file-alt"></i>
                    <p>Générez un rapport pour voir vos statistiques</p>
                </div>
            </div>
        </div>

        <footer>
            <p>Portefeuille Digital Intelligent &copy; 2023 - Développé avec <i class="fas fa-heart" style="color: #e74c3c;"></i> pour KOLA</p>
        </footer>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span>Données sauvegardées avec succès!</span>
    </div>

    <script>
        // Configuration d'authentification
        const AUTH_CONFIG = {
            username: 'KOLA',
            password: 'KOLA1@'
        };

        // Gestion des données
        let walletData = {
            loadedMoney: [],
            expenses: [],
            debts: [],
            pocketMoney: [],
            balance: 0
        };

        // Éléments DOM
        const authContainer = document.getElementById('auth-container');
        const appContainer = document.getElementById('app-container');
        const loginForm = document.getElementById('login-form');
        const logoutBtn = document.getElementById('logout-btn');
        const notification = document.getElementById('notification');

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // Vérifier si l'utilisateur est déjà connecté
            const isLoggedIn = localStorage.getItem('walletAuthenticated');
            if (isLoggedIn) {
                showApp();
                initializeApp();
            } else {
                showAuth();
            }

            // Événements d'authentification
            loginForm.addEventListener('submit', handleLogin);
            logoutBtn.addEventListener('click', handleLogout);
        });

        // Gestion de la connexion
        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === AUTH_CONFIG.username && password === AUTH_CONFIG.password) {
                localStorage.setItem('walletAuthenticated', 'true');
                showApp();
                initializeApp();
                showNotification('Connexion réussie!', 'success');
            } else {
                showNotification('Identifiant ou mot de passe incorrect!', 'error');
            }
        }

        // Gestion de la déconnexion
        function handleLogout() {
            localStorage.removeItem('walletAuthenticated');
            showAuth();
            showNotification('Déconnexion réussie!', 'success');
        }

        // Afficher l'interface d'authentification
        function showAuth() {
            authContainer.style.display = 'flex';
            appContainer.style.display = 'none';
            loginForm.reset();
        }

        // Afficher l'application
        function showApp() {
            authContainer.style.display = 'none';
            appContainer.style.display = 'block';
        }

        // Initialiser l'application
        function initializeApp() {
            loadData();
            updateDashboard();
            updateMonthFilters();
            updateCurrentMonthDisplay();
            updateMonthSummary();
            updateExpensesChart();
            
            // Initialisation de la date du jour dans les formulaires
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('expense-date').value = today;
            document.getElementById('debt-due-date').value = today;
            document.getElementById('pocket-money-date').value = today;
            document.getElementById('loaded-money-date').value = today;
            
            // Événements pour les filtres
            document.getElementById('expense-month-filter').addEventListener('change', renderExpenses);
            document.getElementById('expense-category-filter').addEventListener('change', renderExpenses);
            document.getElementById('debt-month-filter').addEventListener('change', renderDebts);
            document.getElementById('debt-type-filter').addEventListener('change', renderDebts);
            document.getElementById('pocket-money-month-filter').addEventListener('change', renderPocketMoney);
            document.getElementById('loaded-money-month-filter').addEventListener('change', renderLoadedMoney);
            document.getElementById('loaded-money-source-filter').addEventListener('change', renderLoadedMoney);
            document.getElementById('analytics-month-filter').addEventListener('change', updateAnalytics);
            document.getElementById('comparison-month-filter').addEventListener('change', updateComparison);
            
            // Événements pour les rapports
            document.getElementById('generate-report').addEventListener('click', generateReport);
            document.getElementById('export-report').addEventListener('click', exportReport);

            // Événements pour les onglets
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    // Désactiver tous les onglets et sections
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                    
                    // Activer l'onglet cliqué
                    tab.classList.add('active');
                    
                    // Activer la section correspondante
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(`${tabId}-section`).classList.add('active');
                    
                    // Mettre à jour le graphique si on est dans l'onglet analytics
                    if (tabId === 'analytics') {
                        updateExpensesChart();
                        updateAnalytics();
                    }
                    
                    // Mettre à jour le résumé si on est dans l'onglet loaded-money
                    if (tabId === 'loaded-money') {
                        updateMonthSummary();
                    }
                });
            });

            // Événements pour les formulaires
            document.getElementById('expense-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('expense-name').value;
                const amount = parseInt(document.getElementById('expense-amount').value);
                const category = document.getElementById('expense-category').value;
                const date = document.getElementById('expense-date').value;
                
                addExpense(name, amount, category, date);
                this.reset();
                document.getElementById('expense-date').value = new Date().toISOString().split('T')[0];
            });

            document.getElementById('debt-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const name = document.getElementById('debt-name').value;
                const amount = parseInt(document.getElementById('debt-amount').value);
                const type = document.getElementById('debt-type').value;
                const person = document.getElementById('debt-person').value;
                const dueDate = document.getElementById('debt-due-date').value;
                
                addDebt(name, amount, type, person, dueDate);
                this.reset();
                document.getElementById('debt-due-date').value = new Date().toISOString().split('T')[0];
            });

            document.getElementById('pocket-money-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const amount = parseInt(document.getElementById('pocket-money-amount').value);
                const source = document.getElementById('pocket-money-source').value;
                const date = document.getElementById('pocket-money-date').value;
                
                addPocketMoney(amount, source, date);
                this.reset();
                document.getElementById('pocket-money-date').value = new Date().toISOString().split('T')[0];
            });

            document.getElementById('loaded-money-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const amount = parseInt(document.getElementById('loaded-money-amount').value);
                const source = document.getElementById('loaded-money-source').value;
                const date = document.getElementById('loaded-money-date').value;
                const description = document.getElementById('loaded-money-description').value;
                
                addLoadedMoney(amount, source, date, description);
                this.reset();
                document.getElementById('loaded-money-date').value = new Date().toISOString().split('T')[0];
            });

            // Rendu initial
            renderExpenses();
            renderDebts();
            renderPocketMoney();
            renderLoadedMoney();
        }

        // Fonctions pour ajouter des transactions
        function addExpense(name, amount, category, date) {
            const expense = {
                id: Date.now(),
                name,
                amount,
                category,
                date
            };
            
            walletData.expenses.push(expense);
            walletData.balance -= amount;
            
            saveData();
            updateDashboard();
            updateMonthFilters();
            updateMonthSummary();
            renderExpenses();
            showNotification('Dépense ajoutée avec succès!', 'success');
        }

        function addDebt(name, amount, type, person, dueDate) {
            const debt = {
                id: Date.now(),
                name,
                amount,
                type,
                person,
                dueDate: dueDate || new Date().toISOString().split('T')[0]
            };
            
            walletData.debts.push(debt);
            
            // Si c'est une dette que je dois, cela réduit mon solde
            if (type === 'owe') {
                walletData.balance -= amount;
            }
            
            saveData();
            updateDashboard();
            updateMonthFilters();
            updateMonthSummary();
            renderDebts();
            showNotification('Dette ajoutée avec succès!', 'success');
        }

        function addPocketMoney(amount, source, date) {
            const pocketMoney = {
                id: Date.now(),
                amount,
                source,
                date
            };
            
            walletData.pocketMoney.push(pocketMoney);
            walletData.balance += amount;
            
            saveData();
            updateDashboard();
            updateMonthFilters();
            updateMonthSummary();
            renderPocketMoney();
            showNotification('Argent de poche ajouté avec succès!', 'success');
        }

        function addLoadedMoney(amount, source, date, description) {
            const loadedMoney = {
                id: Date.now(),
                amount,
                source,
                date,
                description: description || `Argent chargé - ${source}`
            };
            
            walletData.loadedMoney.push(loadedMoney);
            walletData.balance += amount;
            
            saveData();
            updateDashboard();
            updateMonthFilters();
            updateMonthSummary();
            renderLoadedMoney();
            showNotification('Argent chargé ajouté avec succès!', 'success');
        }

        // Fonctions d'affichage avec filtres
        function renderExpenses() {
            const expensesList = document.getElementById('expenses-list');
            expensesList.innerHTML = '';
            
            const monthFilter = document.getElementById('expense-month-filter').value;
            const categoryFilter = document.getElementById('expense-category-filter').value;
            
            const filteredExpenses = walletData.expenses.filter(expense => {
                const expenseMonth = getMonthYearFromDate(expense.date);
                const monthMatch = monthFilter === 'all' || expenseMonth === monthFilter;
                const categoryMatch = categoryFilter === 'all' || expense.category === categoryFilter;
                
                return monthMatch && categoryMatch;
            });
            
            if (filteredExpenses.length === 0) {
                expensesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-shopping-cart"></i>
                        <p>Aucune dépense trouvée pour les critères sélectionnés</p>
                    </div>
                `;
                return;
            }
            
            filteredExpenses.forEach(expense => {
                const expenseElement = document.createElement('div');
                expenseElement.className = 'transaction-item';
                expenseElement.innerHTML = `
                    <div class="transaction-info">
                        <span class="transaction-name">${expense.name}</span>
                        <span class="transaction-date">${formatDate(expense.date)} - ${expense.category}</span>
                    </div>
                    <div class="transaction-amount expense-amount">- ${formatCurrency(expense.amount)}</div>
                    <div class="action-buttons">
                        <button class="icon-btn delete-btn" onclick="deleteExpense(${expense.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                expensesList.appendChild(expenseElement);
            });
        }

        function renderDebts() {
            const debtsList = document.getElementById('debts-list');
            debtsList.innerHTML = '';
            
            const monthFilter = document.getElementById('debt-month-filter').value;
            const typeFilter = document.getElementById('debt-type-filter').value;
            
            const filteredDebts = walletData.debts.filter(debt => {
                const debtMonth = getMonthYearFromDate(debt.dueDate);
                const monthMatch = monthFilter === 'all' || debtMonth === monthFilter;
                const typeMatch = typeFilter === 'all' || debt.type === typeFilter;
                
                return monthMatch && typeMatch;
            });
            
            if (filteredDebts.length === 0) {
                debtsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-hand-holding-usd"></i>
                        <p>Aucune dette trouvée pour les critères sélectionnés</p>
                    </div>
                `;
                return;
            }
            
            filteredDebts.forEach(debt => {
                const debtElement = document.createElement('div');
                debtElement.className = 'transaction-item';
                
                const amountClass = debt.type === 'owe' ? 'debt-amount' : 'income-amount';
                const amountPrefix = debt.type === 'owe' ? '-' : '+';
                const description = debt.type === 'owe' ? 'Je dois' : 'On me doit';
                
                debtElement.innerHTML = `
                    <div class="transaction-info">
                        <span class="transaction-name">${debt.name}</span>
                        <span class="transaction-date">${description} • ${debt.person} • Échéance: ${formatDate(debt.dueDate)}</span>
                    </div>
                    <div class="transaction-amount ${amountClass}">${amountPrefix} ${formatCurrency(debt.amount)}</div>
                    <div class="action-buttons">
                        <button class="icon-btn delete-btn" onclick="deleteDebt(${debt.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                debtsList.appendChild(debtElement);
            });
        }

        function renderPocketMoney() {
            const pocketMoneyList = document.getElementById('pocket-money-list');
            pocketMoneyList.innerHTML = '';
            
            const monthFilter = document.getElementById('pocket-money-month-filter').value;
            
            const filteredPocketMoney = walletData.pocketMoney.filter(pm => {
                const pmMonth = getMonthYearFromDate(pm.date);
                return monthFilter === 'all' || pmMonth === monthFilter;
            });
            
            if (filteredPocketMoney.length === 0) {
                pocketMoneyList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-coins"></i>
                        <p>Aucun argent de poche trouvé pour les critères sélectionnés</p>
                    </div>
                `;
                return;
            }
            
            filteredPocketMoney.forEach(pm => {
                const pmElement = document.createElement('div');
                pmElement.className = 'transaction-item';
                pmElement.innerHTML = `
                    <div class="transaction-info">
                        <span class="transaction-name">${pm.source}</span>
                        <span class="transaction-date">${formatDate(pm.date)}</span>
                    </div>
                    <div class="transaction-amount pocket-money-amount">+ ${formatCurrency(pm.amount)}</div>
                    <div class="action-buttons">
                        <button class="icon-btn delete-btn" onclick="deletePocketMoney(${pm.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                pocketMoneyList.appendChild(pmElement);
            });
        }

        function renderLoadedMoney() {
            const loadedMoneyList = document.getElementById('loaded-money-list');
            loadedMoneyList.innerHTML = '';
            
            const monthFilter = document.getElementById('loaded-money-month-filter').value;
            const sourceFilter = document.getElementById('loaded-money-source-filter').value;
            
            const filteredLoadedMoney = walletData.loadedMoney.filter(lm => {
                const lmMonth = getMonthYearFromDate(lm.date);
                const monthMatch = monthFilter === 'all' || lmMonth === monthFilter;
                const sourceMatch = sourceFilter === 'all' || lm.source === sourceFilter;
                
                return monthMatch && sourceMatch;
            });
            
            if (filteredLoadedMoney.length === 0) {
                loadedMoneyList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-money-bill-wave"></i>
                        <p>Aucun argent chargé trouvé pour les critères sélectionnés</p>
                    </div>
                `;
                return;
            }
            
            filteredLoadedMoney.forEach(lm => {
                const lmElement = document.createElement('div');
                lmElement.className = 'transaction-item';
                lmElement.innerHTML = `
                    <div class="transaction-info">
                        <span class="transaction-name">${lm.description}</span>
                        <span class="transaction-date">${formatDate(lm.date)} - ${lm.source}</span>
                    </div>
                    <div class="transaction-amount loaded-money-amount">+ ${formatCurrency(lm.amount)}</div>
                    <div class="action-buttons">
                        <button class="icon-btn delete-btn" onclick="deleteLoadedMoney(${lm.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                loadedMoneyList.appendChild(lmElement);
            });
        }

        // Fonctions de suppression
        function deleteExpense(id) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cette dépense?')) {
                const expense = walletData.expenses.find(e => e.id === id);
                walletData.balance += expense.amount;
                walletData.expenses = walletData.expenses.filter(e => e.id !== id);
                
                saveData();
                updateDashboard();
                updateMonthFilters();
                updateMonthSummary();
                renderExpenses();
                showNotification('Dépense supprimée avec succès!', 'success');
            }
        }

        function deleteDebt(id) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cette dette?')) {
                const debt = walletData.debts.find(d => d.id === id);
                
                // Si c'est une dette que je dois, cela augmente mon solde
                if (debt.type === 'owe') {
                    walletData.balance += debt.amount;
                }
                
                walletData.debts = walletData.debts.filter(d => d.id !== id);
                
                saveData();
                updateDashboard();
                updateMonthFilters();
                updateMonthSummary();
                renderDebts();
                showNotification('Dette supprimée avec succès!', 'success');
            }
        }

        function deletePocketMoney(id) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cet argent de poche?')) {
                const pm = walletData.pocketMoney.find(p => p.id === id);
                walletData.balance -= pm.amount;
                walletData.pocketMoney = walletData.pocketMoney.filter(p => p.id !== id);
                
                saveData();
                updateDashboard();
                updateMonthFilters();
                updateMonthSummary();
                renderPocketMoney();
                showNotification('Argent de poche supprimé avec succès!', 'success');
            }
        }

        function deleteLoadedMoney(id) {
            if (confirm('Êtes-vous sûr de vouloir supprimer cet argent chargé?')) {
                const lm = walletData.loadedMoney.find(l => l.id === id);
                walletData.balance -= lm.amount;
                walletData.loadedMoney = walletData.loadedMoney.filter(l => l.id !== id);
                
                saveData();
                updateDashboard();
                updateMonthFilters();
                updateMonthSummary();
                renderLoadedMoney();
                showNotification('Argent chargé supprimé avec succès!', 'success');
            }
        }

        // Mise à jour du tableau de bord
        function updateDashboard() {
            // Calcul des totaux
            const totalExpenses = walletData.expenses.reduce((sum, expense) => sum + expense.amount, 0);
            const totalDebtsOwed = walletData.debts
                .filter(debt => debt.type === 'owe')
                .reduce((sum, debt) => sum + debt.amount, 0);
            const totalPocketMoney = walletData.pocketMoney.reduce((sum, pm) => sum + pm.amount, 0);
            const totalLoadedMoney = walletData.loadedMoney.reduce((sum, lm) => sum + lm.amount, 0);
            
            // Mise à jour des affichages
            document.getElementById('total-balance').textContent = formatCurrency(walletData.balance);
            document.getElementById('total-expenses').textContent = formatCurrency(totalExpenses);
            document.getElementById('total-debts').textContent = formatCurrency(totalDebtsOwed);
            document.getElementById('total-pocket-money').textContent = formatCurrency(totalPocketMoney);
            document.getElementById('total-loaded-money').textContent = formatCurrency(totalLoadedMoney);
        }

        // Mise à jour du résumé du mois en cours
        function updateMonthSummary() {
            const currentMonth = getCurrentMonthYear();
            
            // Calculer les totaux pour le mois en cours
            const monthLoadedMoney = walletData.loadedMoney
                .filter(lm => getMonthYearFromDate(lm.date) === currentMonth)
                .reduce((sum, lm) => sum + lm.amount, 0);
                
            const monthExpenses = walletData.expenses
                .filter(expense => getMonthYearFromDate(expense.date) === currentMonth)
                .reduce((sum, expense) => sum + expense.amount, 0);
                
            const monthDebts = walletData.debts
                .filter(debt => debt.type === 'owe' && getMonthYearFromDate(debt.dueDate) === currentMonth)
                .reduce((sum, debt) => sum + debt.amount, 0);
                
            const monthPocketMoney = walletData.pocketMoney
                .filter(pm => getMonthYearFromDate(pm.date) === currentMonth)
                .reduce((sum, pm) => sum + pm.amount, 0);
                
            const monthBalance = monthLoadedMoney + monthPocketMoney - monthExpenses - monthDebts;
            
            // Mettre à jour l'affichage
            document.getElementById('summary-loaded').textContent = formatCurrency(monthLoadedMoney);
            document.getElementById('summary-expenses').textContent = formatCurrency(monthExpenses);
            document.getElementById('summary-debts').textContent = formatCurrency(monthDebts);
            document.getElementById('summary-pocket-money').textContent = formatCurrency(monthPocketMoney);
            document.getElementById('summary-balance').textContent = formatCurrency(monthBalance);
        }

        // Mise à jour de l'affichage du mois en cours
        function updateCurrentMonthDisplay() {
            const currentMonth = getCurrentMonthYear();
            document.getElementById('current-month-display').textContent = formatMonthYear(currentMonth);
        }

        // Mise à jour des filtres de mois
        function updateMonthFilters() {
            const months = getAllMonthsWithData();
            const monthOptions = months.map(month => 
                `<option value="${month.value}">${month.label}</option>`
            ).join('');
            
            const allOption = '<option value="all">Tous les mois</option>';
            const noneOption = '<option value="none">Aucune comparaison</option>';
            
            // Mettre à jour tous les filtres de mois
            document.getElementById('expense-month-filter').innerHTML = allOption + monthOptions;
            document.getElementById('debt-month-filter').innerHTML = allOption + monthOptions;
            document.getElementById('pocket-money-month-filter').innerHTML = allOption + monthOptions;
            document.getElementById('loaded-money-month-filter').innerHTML = allOption + monthOptions;
            document.getElementById('analytics-month-filter').innerHTML = monthOptions;
            document.getElementById('comparison-month-filter').innerHTML = noneOption + monthOptions;
            
            // Sélectionner le mois en cours par défaut dans analytics
            const currentMonth = getCurrentMonthYear();
            const analyticsFilter = document.getElementById('analytics-month-filter');
            for (let i = 0; i < analyticsFilter.options.length; i++) {
                if (analyticsFilter.options[i].value === currentMonth) {
                    analyticsFilter.selectedIndex = i;
                    break;
                }
            }
        }

        // Obtenir tous les mois avec des données
        function getAllMonthsWithData() {
            const monthsSet = new Set();
            
            // Ajouter les mois de l'argent chargé
            walletData.loadedMoney.forEach(lm => {
                monthsSet.add(getMonthYearFromDate(lm.date));
            });
            
            // Ajouter les mois des dépenses
            walletData.expenses.forEach(expense => {
                monthsSet.add(getMonthYearFromDate(expense.date));
            });
            
            // Ajouter les mois des dettes
            walletData.debts.forEach(debt => {
                monthsSet.add(getMonthYearFromDate(debt.dueDate));
            });
            
            // Ajouter les mois de l'argent de poche
            walletData.pocketMoney.forEach(pm => {
                monthsSet.add(getMonthYearFromDate(pm.date));
            });
            
            // Convertir en tableau et trier
            const months = Array.from(monthsSet).sort((a, b) => {
                const [aYear, aMonth] = a.split('-').map(Number);
                const [bYear, bMonth] = b.split('-').map(Number);
                
                if (aYear !== bYear) return bYear - aYear;
                return bMonth - aMonth;
            });
            
            // Formater pour l'affichage
            return months.map(month => {
                const [year, monthNum] = month.split('-').map(Number);
                const monthNames = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 
                                   'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];
                
                return {
                    value: month,
                    label: `${monthNames[monthNum - 1]} ${year}`
                };
            });
        }

        // Obtenir le mois et l'année d'une date
        function getMonthYearFromDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            return `${year}-${month.toString().padStart(2, '0')}`;
        }

        // Obtenir le mois et l'année actuels
        function getCurrentMonthYear() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            return `${year}-${month.toString().padStart(2, '0')}`;
        }

        // Mise à jour des statistiques
        function updateAnalytics() {
            const selectedMonth = document.getElementById('analytics-month-filter').value;
            const monthExpenses = walletData.expenses.filter(expense => 
                getMonthYearFromDate(expense.date) === selectedMonth
            );
            
            if (monthExpenses.length === 0) {
                document.getElementById('highest-expense').textContent = '0 FCFA';
                document.getElementById('highest-expense-name').textContent = '-';
                document.getElementById('average-expense').textContent = '0 FCFA';
                document.getElementById('main-category').textContent = '-';
                document.getElementById('main-category-percent').textContent = '0%';
                return;
            }
            
            // Dépense la plus élevée
            const highestExpense = monthExpenses.reduce((max, expense) => 
                expense.amount > max.amount ? expense : max, monthExpenses[0]);
            document.getElementById('highest-expense').textContent = formatCurrency(highestExpense.amount);
            document.getElementById('highest-expense-name').textContent = highestExpense.name;
            
            // Moyenne des dépenses par jour
            const monthDate = new Date(selectedMonth + '-01');
            const daysInMonth = new Date(monthDate.getFullYear(), monthDate.getMonth() + 1, 0).getDate();
            const totalExpenses = monthExpenses.reduce((sum, expense) => sum + expense.amount, 0);
            const averageExpense = Math.round(totalExpenses / daysInMonth);
            document.getElementById('average-expense').textContent = formatCurrency(averageExpense);
            
            // Catégorie principale
            const categories = {};
            monthExpenses.forEach(expense => {
                categories[expense.category] = (categories[expense.category] || 0) + expense.amount;
            });
            
            let mainCategory = '';
            let mainCategoryAmount = 0;
            
            for (const category in categories) {
                if (categories[category] > mainCategoryAmount) {
                    mainCategory = category;
                    mainCategoryAmount = categories[category];
                }
            }
            
            const mainCategoryPercent = Math.round((mainCategoryAmount / totalExpenses) * 100);
            document.getElementById('main-category').textContent = mainCategory;
            document.getElementById('main-category-percent').textContent = `${mainCategoryPercent}%`;
            
            // Mettre à jour le graphique
            updateExpensesChart(selectedMonth);
            
            // Mettre à jour la comparaison si activée
            updateComparison();
        }

        // Mise à jour de la comparaison
        function updateComparison() {
            const selectedMonth = document.getElementById('analytics-month-filter').value;
            const comparisonMonth = document.getElementById('comparison-month-filter').value;
            
            if (comparisonMonth === 'none') {
                document.getElementById('comparison-section').style.display = 'none';
                return;
            }
            
            document.getElementById('comparison-section').style.display = 'block';
            
            // Calculer les totaux pour le mois sélectionné
            const selectedMonthLoadedMoney = walletData.loadedMoney
                .filter(lm => getMonthYearFromDate(lm.date) === selectedMonth)
                .reduce((sum, lm) => sum + lm.amount, 0);
                
            const selectedMonthExpenses = walletData.expenses
                .filter(expense => getMonthYearFromDate(expense.date) === selectedMonth)
                .reduce((sum, expense) => sum + expense.amount, 0);
                
            const selectedMonthDebts = walletData.debts
                .filter(debt => debt.type === 'owe' && getMonthYearFromDate(debt.dueDate) === selectedMonth)
                .reduce((sum, debt) => sum + debt.amount, 0);
                
            const selectedMonthPocketMoney = walletData.pocketMoney
                .filter(pm => getMonthYearFromDate(pm.date) === selectedMonth)
                .reduce((sum, pm) => sum + pm.amount, 0);
            
            // Calculer les totaux pour le mois de comparaison
            const comparisonMonthLoadedMoney = walletData.loadedMoney
                .filter(lm => getMonthYearFromDate(lm.date) === comparisonMonth)
                .reduce((sum, lm) => sum + lm.amount, 0);
                
            const comparisonMonthExpenses = walletData.expenses
                .filter(expense => getMonthYearFromDate(expense.date) === comparisonMonth)
                .reduce((sum, expense) => sum + expense.amount, 0);
                
            const comparisonMonthDebts = walletData.debts
                .filter(debt => debt.type === 'owe' && getMonthYearFromDate(debt.dueDate) === comparisonMonth)
                .reduce((sum, debt) => sum + debt.amount, 0);
                
            const comparisonMonthPocketMoney = walletData.pocketMoney
                .filter(pm => getMonthYearFromDate(pm.date) === comparisonMonth)
                .reduce((sum, pm) => sum + pm.amount, 0);
            
            // Afficher les valeurs
            document.getElementById('comparison-loaded-money').textContent = formatCurrency(selectedMonthLoadedMoney);
            document.getElementById('comparison-expenses').textContent = formatCurrency(selectedMonthExpenses);
            document.getElementById('comparison-debts').textContent = formatCurrency(selectedMonthDebts);
            document.getElementById('comparison-pocket-money').textContent = formatCurrency(selectedMonthPocketMoney);
            
            // Calculer et afficher les changements
            displayChange('loaded-money-change', selectedMonthLoadedMoney, comparisonMonthLoadedMoney);
            displayChange('expenses-change', selectedMonthExpenses, comparisonMonthExpenses);
            displayChange('debts-change', selectedMonthDebts, comparisonMonthDebts);
            displayChange('pocket-money-change', selectedMonthPocketMoney, comparisonMonthPocketMoney);
        }

        // Afficher le changement en pourcentage
        function displayChange(elementId, currentValue, previousValue) {
            const element = document.getElementById(elementId);
            
            if (previousValue === 0) {
                element.textContent = 'Nouveau';
                element.className = 'positive-change';
                return;
            }
            
            const change = ((currentValue - previousValue) / previousValue) * 100;
            const changeFormatted = Math.abs(change).toFixed(1);
            
            if (change > 0) {
                element.textContent = `+${changeFormatted}%`;
                element.className = 'positive-change';
            } else if (change < 0) {
                element.textContent = `-${changeFormatted}%`;
                element.className = 'negative-change';
            } else {
                element.textContent = '0%';
                element.className = '';
            }
        }

        // Graphique des dépenses
        let expensesChart = null;

        function updateExpensesChart(month = null) {
            const ctx = document.getElementById('expenses-chart').getContext('2d');
            
            // Filtrer les dépenses par mois si spécifié
            let expensesToChart = walletData.expenses;
            if (month) {
                expensesToChart = walletData.expenses.filter(expense => 
                    getMonthYearFromDate(expense.date) === month
                );
            }
            
            // Regrouper les dépenses par catégorie
            const categories = {};
            expensesToChart.forEach(expense => {
                categories[expense.category] = (categories[expense.category] || 0) + expense.amount;
            });
            
            const categoryNames = Object.keys(categories);
            const categoryAmounts = Object.values(categories);
            
            // Couleurs pour les catégories
            const backgroundColors = [
                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', 
                '#9966FF', '#FF9F40', '#8AC926', '#1982C4'
            ];
            
            if (expensesChart) {
                expensesChart.destroy();
            }
            
            expensesChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: categoryNames,
                    datasets: [{
                        data: categoryAmounts,
                        backgroundColor: backgroundColors.slice(0, categoryNames.length),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        title: {
                            display: true,
                            text: month ? `Répartition des dépenses - ${formatMonthYear(month)}` : 'Répartition des dépenses par catégorie'
                        }
                    }
                }
            });
        }

        // Génération de rapport
        function generateReport() {
            const reportContent = document.getElementById('report-content');
            reportContent.innerHTML = '<p>Génération du rapport en cours...</p>';
            
            setTimeout(() => {
                const sixMonthsAgo = new Date();
                sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 5); // 6 mois incluant le mois actuel
                
                const months = [];
                for (let i = 0; i < 6; i++) {
                    const date = new Date(sixMonthsAgo);
                    date.setMonth(date.getMonth() + i);
                    const monthYear = getMonthYearFromDate(date.toISOString());
                    months.push(monthYear);
                }
                
                let reportHTML = `
                    <h3>Rapport des 6 Derniers Mois</h3>
                    <div class="comparison-cards">
                `;
                
                // Calculer les totaux pour chaque mois
                months.forEach(month => {
                    const monthLoadedMoney = walletData.loadedMoney
                        .filter(lm => getMonthYearFromDate(lm.date) === month)
                        .reduce((sum, lm) => sum + lm.amount, 0);
                        
                    const monthExpenses = walletData.expenses
                        .filter(expense => getMonthYearFromDate(expense.date) === month)
                        .reduce((sum, expense) => sum + expense.amount, 0);
                        
                    const monthDebts = walletData.debts
                        .filter(debt => debt.type === 'owe' && getMonthYearFromDate(debt.dueDate) === month)
                        .reduce((sum, debt) => sum + debt.amount, 0);
                        
                    const monthPocketMoney = walletData.pocketMoney
                        .filter(pm => getMonthYearFromDate(pm.date) === month)
                        .reduce((sum, pm) => sum + pm.amount, 0);
                        
                    const monthBalance = monthLoadedMoney + monthPocketMoney - monthExpenses - monthDebts;
                    
                    reportHTML += `
                        <div class="comparison-card">
                            <h4>${formatMonthYear(month)}</h4>
                            <div class="amount loaded-money-amount">${formatCurrency(monthLoadedMoney)}</div>
                            <div>Argent chargé</div>
                            <div class="amount expense-amount">${formatCurrency(monthExpenses)}</div>
                            <div>Dépenses</div>
                            <div class="amount debt-amount">${formatCurrency(monthDebts)}</div>
                            <div>Dettes</div>
                            <div class="amount pocket-money-amount">${formatCurrency(monthPocketMoney)}</div>
                            <div>Revenus</div>
                            <div class="amount ${monthBalance >= 0 ? 'income-amount' : 'expense-amount'}">${formatCurrency(monthBalance)}</div>
                            <div>Solde</div>
                        </div>
                    `;
                });
                
                reportHTML += '</div>';
                
                // Ajouter un résumé
                const totalLoadedMoney = months.reduce((sum, month) => {
                    return sum + walletData.loadedMoney
                        .filter(lm => getMonthYearFromDate(lm.date) === month)
                        .reduce((monthSum, lm) => monthSum + lm.amount, 0);
                }, 0);
                
                const totalExpenses = months.reduce((sum, month) => {
                    return sum + walletData.expenses
                        .filter(expense => getMonthYearFromDate(expense.date) === month)
                        .reduce((monthSum, expense) => monthSum + expense.amount, 0);
                }, 0);
                
                const averageExpenses = Math.round(totalExpenses / 6);
                
                reportHTML += `
                    <div style="margin-top: 30px;">
                        <h4>Résumé des 6 Derniers Mois</h4>
                        <p>Argent chargé total: <strong>${formatCurrency(totalLoadedMoney)}</strong></p>
                        <p>Dépenses totales: <strong>${formatCurrency(totalExpenses)}</strong></p>
                        <p>Dépenses moyennes par mois: <strong>${formatCurrency(averageExpenses)}</strong></p>
                        <p>Économies moyennes par mois: <strong>${formatCurrency(Math.round((totalLoadedMoney - totalExpenses) / 6))}</strong></p>
                    </div>
                `;
                
                reportContent.innerHTML = reportHTML;
                showNotification('Rapport généré avec succès!', 'success');
            }, 1000);
        }

        // Exportation en PDF (simulée)
        function exportReport() {
            showNotification('Fonction d\'export PDF à implémenter', 'warning');
        }

        // Formatage
        function formatCurrency(amount) {
            return new Intl.NumberFormat('fr-FR').format(amount) + ' FCFA';
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('fr-FR');
        }

        function formatMonthYear(monthYear) {
            const [year, month] = monthYear.split('-').map(Number);
            const monthNames = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 
                               'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];
            return `${monthNames[month - 1]} ${year}`;
        }

        // Notifications améliorées
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const icon = notification.querySelector('i');
            
            // Changer l'icône et la couleur selon le type
            if (type === 'error') {
                notification.className = 'notification error show';
                icon.className = 'fas fa-exclamation-circle';
            } else if (type === 'warning') {
                notification.className = 'notification warning show';
                icon.className = 'fas fa-exclamation-triangle';
            } else {
                notification.className = 'notification show';
                icon.className = 'fas fa-check-circle';
            }
            
            notification.querySelector('span').textContent = message;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Sauvegarde et chargement des données
        function saveData() {
            localStorage.setItem('walletData', JSON.stringify(walletData));
        }

        function loadData() {
            const savedData = localStorage.getItem('walletData');
            if (savedData) {
                walletData = JSON.parse(savedData);
            }
        }
    </script>
</body>
</html>