<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceMaster Togo | Gestion Financi√®re</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            /* Couleurs du drapeau togolais */
            --togo-green: #008751;
            --togo-yellow: #FFD100;
            --togo-red: #D21034;
            --togo-dark: #006442;
            --togo-light: #FFFCE6;
            
            /* Couleurs principales */
            --primary: var(--togo-green);
            --primary-dark: #00693E;
            --secondary: var(--togo-yellow);
            --accent: var(--togo-red);
            --success: #2ECC71;
            --danger: #E74C3C;
            --warning: #F39C12;
            --info: #3498DB;
            
            /* Tailles compactes */
            --sidebar-width: 220px;
            --btn-padding: 0.5rem 1rem;
            --btn-font-size: 0.85rem;
            --nav-padding: 0.6rem 1rem;
            --icon-size: 18px;
        }
        
        /* Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, var(--togo-light) 0%, #FFFFFF 100%);
            color: #2C3E50;
            min-height: 100vh;
            font-size: 14px;
        }
        
        /* Layout compact */
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar compacte */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--togo-green) 0%, var(--togo-dark) 100%);
            color: white;
            padding: 1.5rem 0;
            display: flex;
            flex-direction: column;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .sidebar-header {
            padding: 0 1rem 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--togo-yellow) 0%, var(--togo-red) 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .logo-text h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .logo-text span {
            font-size: 0.75rem;
            color: var(--togo-yellow);
        }
        
        /* Navigation compacte */
        .nav-menu {
            flex: 1;
            padding: 1rem 0;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .nav-item {
            padding: var(--nav-padding);
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(255,255,255,0.9);
            transition: all 0.2s;
            margin: 0 0.5rem;
            border-radius: 6px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 0.85rem;
            text-align: left;
            text-decoration: none;
        }
        
        .nav-item:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .nav-item.active {
            background: rgba(255,255,255,0.15);
            font-weight: 600;
        }
        
        .nav-icon {
            font-size: var(--icon-size);
            width: 20px;
            color: var(--togo-yellow);
        }
        
        .sidebar-footer {
            padding: 1rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--togo-yellow) 0%, var(--togo-red) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            color: white;
            font-weight: bold;
        }
        
        .user-details h4 {
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .user-details span {
            font-size: 0.75rem;
            color: var(--togo-yellow);
        }
        
        /* Contenu principal */
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
            background: rgba(255,252,230,0.95);
        }
        
        /* Header compact */
        .header {
            background: linear-gradient(90deg, var(--togo-green) 0%, var(--togo-dark) 100%);
            padding: 1rem 1.5rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--togo-yellow);
        }
        
        .page-title {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .page-title h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: white;
        }
        
        .page-title i {
            color: var(--togo-yellow);
            font-size: 1.2rem;
        }
        
        .header-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        /* Boutons compacts */
        .btn {
            padding: var(--btn-padding);
            border: none;
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: var(--btn-font-size);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
            text-transform: none;
            letter-spacing: normal;
            white-space: nowrap;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn i {
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--togo-green) 0%, var(--togo-dark) 100%);
            color: white;
            border: 1px solid var(--togo-yellow);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #219653 100%);
            color: white;
            border: 1px solid var(--togo-yellow);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%);
            color: white;
            border: 1px solid var(--togo-yellow);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #D35400 100%);
            color: white;
            border: 1px solid var(--togo-yellow);
        }
        
        .btn-info {
            background: linear-gradient(135deg, var(--info) 0%, #2980B9 100%);
            color: white;
            border: 1px solid var(--togo-yellow);
        }
        
        .btn-light {
            background: rgba(255,255,255,0.9);
            color: var(--togo-dark);
            border: 1px solid var(--togo-green);
        }
        
        .btn-small {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
        }
        
        /* Sections */
        .content-section {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--togo-yellow);
            display: none;
        }
        
        .content-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--togo-yellow);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--togo-dark);
        }
        
        .section-title i {
            color: var(--togo-red);
            font-size: 1.1rem;
        }
        
        /* Cartes compactes */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .card {
            background: linear-gradient(135deg, white 0%, var(--togo-light) 100%);
            border-radius: 8px;
            padding: 1.2rem;
            border: 1px solid var(--togo-green);
            transition: all 0.2s;
        }
        
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .card-icon {
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
            background: linear-gradient(135deg, var(--togo-green) 0%, var(--togo-dark) 100%);
        }
        
        .card-title {
            font-size: 0.85rem;
            color: var(--togo-dark);
            font-weight: 600;
        }
        
        .card-value {
            font-size: 1.5rem;
            font-weight: 800;
            margin: 0.5rem 0;
            color: var(--togo-dark);
            font-family: 'Poppins', sans-serif;
        }
        
        .card-trend {
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .trend-up {
            color: var(--success);
        }
        
        .trend-down {
            color: var(--danger);
        }
        
        /* Tableaux */
        .table-container {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid var(--togo-green);
        }
        
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            min-width: 700px;
            font-size: 0.85rem;
        }
        
        .data-table thead {
            background: linear-gradient(90deg, var(--togo-green) 0%, var(--togo-dark) 100%);
            color: white;
        }
        
        .data-table th {
            padding: 0.8rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.85rem;
            border-bottom: 2px solid var(--togo-yellow);
        }
        
        .data-table td {
            padding: 0.8rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .data-table tbody tr:hover {
            background: var(--togo-light);
        }
        
        /* Badges */
        .badge {
            padding: 0.3rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .badge-success {
            background: linear-gradient(135deg, var(--togo-green) 0%, var(--success) 100%);
            color: white;
        }
        
        .badge-danger {
            background: linear-gradient(135deg, var(--togo-red) 0%, var(--danger) 100%);
            color: white;
        }
        
        .badge-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #E67E22 100%);
            color: white;
        }
        
        .badge-info {
            background: linear-gradient(135deg, var(--info) 0%, #2980B9 100%);
            color: white;
        }
        
        /* Formulaires */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.4rem;
            font-weight: 600;
            color: var(--togo-dark);
            font-size: 0.85rem;
        }
        
        .form-control {
            width: 100%;
            padding: 0.6rem 0.8rem;
            border: 1px solid var(--togo-green);
            border-radius: 6px;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85rem;
            background: var(--togo-light);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--togo-yellow);
            box-shadow: 0 0 0 2px rgba(255, 209, 0, 0.2);
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--togo-yellow);
        }
        
        /* Graphiques */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .chart-card {
            background: white;
            border-radius: 8px;
            padding: 1.2rem;
            border: 1px solid var(--togo-green);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .chart-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--togo-dark);
        }
        
        .chart-container {
            height: 250px;
            position: relative;
        }
        
        /* Filtres */
        .filter-section {
            background: linear-gradient(135deg, var(--togo-light) 0%, white 100%);
            border-radius: 8px;
            padding: 1.2rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--togo-green);
        }
        
        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .filter-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--togo-yellow);
        }
        
        /* Modal compact */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,100,66,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: linear-gradient(135deg, white 0%, var(--togo-light) 100%);
            border-radius: 10px;
            width: 100%;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
            border: 2px solid var(--togo-yellow);
        }
        
        .modal-header {
            padding: 1rem 1.5rem;
            border-bottom: 2px solid var(--togo-yellow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(90deg, var(--togo-green) 0%, var(--togo-dark) 100%);
            color: white;
            border-radius: 10px 10px 0 0;
        }
        
        .modal-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--togo-yellow);
            cursor: pointer;
            line-height: 1;
            padding: 0;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 2px solid var(--togo-yellow);
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            background: var(--togo-light);
            border-radius: 0 0 10px 10px;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 0.8rem 1.2rem;
            border-radius: 6px;
            color: white;
            font-weight: 600;
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 8px;
            transform: translateX(400px);
            transition: transform 0.3s;
            font-size: 0.85rem;
            max-width: 300px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-success {
            background: linear-gradient(135deg, var(--togo-green) 0%, var(--success) 100%);
        }
        
        .notification-error {
            background: linear-gradient(135deg, var(--togo-red) 0%, var(--danger) 100%);
        }
        
        .notification-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #D35400 100%);
        }
        
        /* Boutons avec ic√¥nes */
        .btn-icon {
            width: 35px;
            height: 35px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--togo-green) 0%, var(--togo-dark) 100%);
            border: 1px solid var(--togo-yellow);
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            border: none;
        }
        
        .btn-icon:hover {
            transform: scale(1.05);
        }
        
        /* Mobile menu */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 0.5rem;
            left: 0.5rem;
            z-index: 999;
            width: 40px;
            height: 40px;
            border-radius: 6px;
            background: linear-gradient(135deg, var(--togo-green) 0%, var(--togo-dark) 100%);
            border: 1px solid var(--togo-yellow);
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            border: none;
        }
        
        /* Login Screen */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            background: linear-gradient(135deg, var(--togo-green) 0%, var(--togo-dark) 100%);
        }
        
        .login-card {
            background: white;
            border-radius: 15px;
            padding: 2.5rem;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 3px solid var(--togo-yellow);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .login-logo {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 1rem;
        }
        
        .login-logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--togo-yellow) 0%, var(--togo-red) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .login-logo-text h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            color: var(--togo-dark);
        }
        
        .login-logo-text span {
            font-size: 0.9rem;
            color: var(--togo-red);
        }
        
        .login-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1.3rem;
            color: var(--togo-dark);
            margin-bottom: 0.5rem;
        }
        
        .login-subtitle {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 2rem;
        }
        
        .login-switch {
            text-align: center;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #eee;
        }
        
        .login-switch a {
            color: var(--togo-green);
            text-decoration: none;
            font-weight: 600;
        }
        
        .login-switch a:hover {
            text-decoration: underline;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                position: fixed;
                top: 0;
                left: 0;
                transform: translateY(-100%);
                z-index: 1000;
                height: auto;
            }
            
            .sidebar.active {
                transform: translateY(0);
            }
            
            .nav-menu {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                gap: 4px;
                padding: 0.5rem;
            }
            
            .nav-item {
                flex: 1;
                min-width: 100px;
                padding: 0.5rem;
                font-size: 0.8rem;
            }
            
            .mobile-menu-toggle {
                display: flex;
            }
            
            .main-content {
                padding-top: 3.5rem;
            }
            
            .header {
                padding: 0.8rem 1rem;
            }
            
            .header-actions {
                flex-wrap: wrap;
            }
            
            .btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }
        }
        
        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                gap: 0.8rem;
                align-items: flex-start;
            }
            
            .header {
                flex-direction: column;
                gap: 0.8rem;
                align-items: flex-start;
            }
            
            .header-actions {
                width: 100%;
            }
            
            .login-card {
                padding: 1.5rem;
            }
        }
        
        @media (max-width: 576px) {
            .main-content {
                padding: 1rem;
            }
            
            .content-section {
                padding: 1rem;
            }
            
            .modal-body {
                padding: 1rem;
            }
            
            .notification {
                left: 0.5rem;
                right: 0.5rem;
                max-width: none;
            }
        }
        
        /* Utilitaires */
        .text-success { color: var(--togo-green) !important; }
        .text-danger { color: var(--togo-red) !important; }
        .text-warning { color: var(--warning) !important; }
        .font-weight-bold { font-weight: 700 !important; }
        
        .progress-bar {
            height: 6px;
            background: var(--togo-light);
            border-radius: 3px;
            margin: 0.5rem 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--togo-green) 0%, var(--togo-yellow) 50%, var(--togo-red) 100%);
            border-radius: 3px;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.3rem;
            margin-top: 1.5rem;
        }
        
        .page-link {
            padding: 0.4rem 0.8rem;
            border: 1px solid var(--togo-green);
            border-radius: 4px;
            background: white;
            color: var(--togo-dark);
            cursor: pointer;
            font-size: 0.85rem;
            text-decoration: none;
        }
        
        .page-link:hover {
            background: var(--togo-light);
        }
        
        .page-link.active {
            background: var(--togo-green);
            color: white;
            border-color: var(--togo-green);
        }
        
        /* Param√®tres */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .setting-card {
            background: linear-gradient(135deg, white 0%, var(--togo-light) 100%);
            border-radius: 8px;
            padding: 1.5rem;
            border: 1px solid var(--togo-green);
        }
        
        .setting-title {
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--togo-dark);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Boutons d'action */
        .action-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        /* √âtat vierge */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #666;
        }
        
        .empty-state-icon {
            font-size: 3rem;
            color: var(--togo-green);
            margin-bottom: 1rem;
        }
        
        .empty-state-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--togo-dark);
        }
        
        .empty-state-description {
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
</head>
<body>
    <!-- √âcran de connexion/cr√©ation de compte -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="login-logo">
                    <div class="login-logo-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="login-logo-text">
                        <h1>FinanceMaster</h1>
                        <span>Togo üáπüá¨</span>
                    </div>
                </div>
                <h2 class="login-title" id="loginTitle">Connexion</h2>
                <p class="login-subtitle" id="loginSubtitle">Acc√©dez √† votre tableau de bord de gestion financi√®re</p>
            </div>
            
            <!-- Formulaire Connexion -->
            <form id="loginForm" style="display: block;">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="loginEmail" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Mot de passe</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-light btn-small" id="switchToRegister">
                        Cr√©er un compte
                    </button>
                    <button type="submit" class="btn btn-primary btn-small">
                        <i class="fas fa-sign-in-alt"></i>
                        Se connecter
                    </button>
                </div>
            </form>
            
            <!-- Formulaire Cr√©ation de compte -->
            <form id="registerForm" style="display: none;">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Nom</label>
                        <input type="text" class="form-control" id="registerLastName" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Pr√©nom</label>
                        <input type="text" class="form-control" id="registerFirstName" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="registerEmail" required>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label">Mot de passe</label>
                        <input type="password" class="form-control" id="registerPassword" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirmation</label>
                        <input type="password" class="form-control" id="registerConfirmPassword" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">R√¥le</label>
                    <select class="form-control" id="registerRole" required>
                        <option value="gestionnaire">Gestionnaire</option>
                        <option value="administrateur">Administrateur</option>
                    </select>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-light btn-small" id="switchToLogin">
                        D√©j√† un compte ?
                    </button>
                    <button type="submit" class="btn btn-success btn-small">
                        <i class="fas fa-user-plus"></i>
                        Cr√©er le compte
                    </button>
                </div>
            </form>
            
            <div class="login-switch">
                <span id="switchText">Pas encore de compte ? </span>
                <a href="#" id="switchLink">Cr√©er un compte gestionnaire</a>
            </div>
        </div>
    </div>
    
    <!-- Application principale (cach√©e par d√©faut) -->
    <div id="appContainer" style="display: none;">
        <!-- Mobile menu toggle -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
            <i class="fas fa-bars"></i>
        </button>
        
        <div class="app-container">
            <!-- Sidebar compacte -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <div class="logo">
                        <div class="logo-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="logo-text">
                            <h1>FinanceMaster</h1>
                            <span>Togo üáπüá¨</span>
                        </div>
                    </div>
                </div>
                
                <nav class="nav-menu">
                    <button class="nav-item active" data-section="dashboard">
                        <i class="nav-icon fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </button>
                    <button class="nav-item" data-section="transactions">
                        <i class="nav-icon fas fa-exchange-alt"></i>
                        <span>Transactions</span>
                    </button>
                    <button class="nav-item" data-section="categories">
                        <i class="nav-icon fas fa-tags"></i>
                        <span>Cat√©gories</span>
                    </button>
                    <button class="nav-item" data-section="reports">
                        <i class="nav-icon fas fa-chart-bar"></i>
                        <span>Rapports</span>
                    </button>
                    <button class="nav-item" data-section="users">
                        <i class="nav-icon fas fa-users"></i>
                        <span>Gestionnaires</span>
                    </button>
                    <button class="nav-item" data-section="settings">
                        <i class="nav-icon fas fa-cog"></i>
                        <span>Param√®tres</span>
                    </button>
                </nav>
                
                <div class="sidebar-footer">
                    <div class="user-info">
                        <div class="user-avatar" id="userAvatar">
                            A
                        </div>
                        <div class="user-details">
                            <h4 id="userName">Admin</h4>
                            <span id="userRole">Administrateur</span>
                        </div>
                        <button class="btn-icon" id="logoutBtn" title="D√©connexion" style="margin-left: auto; background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%);">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </aside>
            
            <!-- Contenu principal -->
            <main class="main-content">
                <!-- Header compact -->
                <header class="header">
                    <div class="page-title">
                        <i class="fas fa-tachometer-alt"></i>
                        <h1>Dashboard</h1>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-primary btn-small" id="quickAddBtn">
                            <i class="fas fa-plus"></i>
                            Ajouter Transaction
                        </button>
                        <button class="btn btn-light btn-small" id="exportBtn">
                            <i class="fas fa-download"></i>
                            Exporter
                        </button>
                        <button class="btn btn-danger btn-small" id="resetDataBtn">
                            <i class="fas fa-trash"></i>
                            R√©initialiser
                        </button>
                    </div>
                </header>
                
                <!-- Section Dashboard -->
                <section class="content-section active" id="dashboard-section">
                    <!-- Statistiques -->
                    <div class="cards-grid">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-arrow-up"></i>
                                </div>
                                <div class="card-title">Revenus</div>
                            </div>
                            <div class="card-value" id="totalIncome">0 FCFA</div>
                            <div class="card-trend trend-up">
                                <i class="fas fa-arrow-up"></i>
                                <span id="incomeTrend">+0%</span>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon" style="background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%);">
                                    <i class="fas fa-arrow-down"></i>
                                </div>
                                <div class="card-title">D√©penses</div>
                            </div>
                            <div class="card-value" id="totalExpense">0 FCFA</div>
                            <div class="card-trend trend-down">
                                <i class="fas fa-arrow-down"></i>
                                <span id="expenseTrend">-0%</span>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="card-title">Solde</div>
                            </div>
                            <div class="card-value" id="totalBalance">0 FCFA</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="balanceProgress" style="width: 50%"></div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon" style="background: linear-gradient(135deg, var(--info) 0%, #2980B9 100%);">
                                    <i class="fas fa-wallet"></i>
                                </div>
                                <div class="card-title">Transactions</div>
                            </div>
                            <div class="card-value" id="totalTransactions">0</div>
                            <div class="card-trend">
                                <i class="fas fa-exchange-alt"></i>
                                <span id="transactionCount">Ce mois</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Graphiques -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <i class="fas fa-chart-line"></i>
                                    √âvolution mensuelle
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="monthlyChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-card">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <i class="fas fa-chart-pie"></i>
                                    R√©partition des d√©penses
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="expenseChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Derni√®res transactions -->
                    <div class="content-section">
                        <div class="section-header">
                            <div class="section-title">
                                <i class="fas fa-history"></i>
                                <h2>Derni√®res Transactions</h2>
                            </div>
                            <button class="btn btn-primary btn-small" id="viewAllBtn">
                                <i class="fas fa-eye"></i>
                                Voir tout
                            </button>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Description</th>
                                        <th>Cat√©gorie</th>
                                        <th>Montant</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="recentTransactions">
                                    <!-- Donn√©es dynamiques -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
                
                <!-- Section Transactions -->
                <section class="content-section" id="transactions-section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-exchange-alt"></i>
                            <h2>Transactions</h2>
                        </div>
                        <button class="btn btn-primary btn-small" id="newTransactionBtn">
                            <i class="fas fa-plus"></i>
                            Nouvelle
                        </button>
                    </div>
                    
                    <!-- √âtat vierge -->
                    <div id="transactionsEmptyState" class="empty-state" style="display: none;">
                        <div class="empty-state-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h3 class="empty-state-title">Aucune transaction</h3>
                        <p class="empty-state-description">
                            Commencez par ajouter votre premi√®re transaction pour g√©rer vos finances.
                        </p>
                        <button class="btn btn-primary btn-small" id="addFirstTransactionBtn">
                            <i class="fas fa-plus"></i>
                            Ajouter une transaction
                        </button>
                    </div>
                    
                    <!-- Filtres -->
                    <div class="filter-section" id="transactionsFilters" style="display: none;">
                        <div class="filter-row">
                            <div class="form-group">
                                <label class="form-label">P√©riode</label>
                                <div style="display: flex; gap: 5px;">
                                    <input type="date" class="form-control" id="filterStartDate">
                                    <input type="date" class="form-control" id="filterEndDate">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Type</label>
                                <select class="form-control" id="filterType">
                                    <option value="">Tous</option>
                                    <option value="income">Revenus</option>
                                    <option value="expense">D√©penses</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Cat√©gorie</label>
                                <select class="form-control" id="filterCategory">
                                    <option value="">Toutes</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Montant min</label>
                                <input type="number" class="form-control" id="filterMinAmount" placeholder="0">
                            </div>
                        </div>
                        
                        <div class="filter-actions">
                            <button class="btn btn-light btn-small" id="resetFiltersBtn">
                                <i class="fas fa-times"></i>
                                R√©initialiser
                            </button>
                            <button class="btn btn-primary btn-small" id="applyFiltersBtn">
                                <i class="fas fa-filter"></i>
                                Filtrer
                            </button>
                        </div>
                    </div>
                    
                    <!-- Liste -->
                    <div class="table-container" id="transactionsTable" style="display: none;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Cat√©gorie</th>
                                    <th>Type</th>
                                    <th>Montant</th>
                                    <th>Cr√©√© par</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="transactionsList">
                                <!-- Donn√©es dynamiques -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination -->
                    <div class="pagination" id="transactionsPagination" style="display: none;">
                        <!-- G√©n√©r√©e dynamiquement -->
                    </div>
                </section>
                
                <!-- Section Cat√©gories -->
                <section class="content-section" id="categories-section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-tags"></i>
                            <h2>Cat√©gories</h2>
                        </div>
                        <button class="btn btn-primary btn-small" id="newCategoryBtn">
                            <i class="fas fa-plus"></i>
                            Ajouter Cat√©gorie
                        </button>
                    </div>
                    
                    <div class="cards-grid">
                        <!-- Revenus -->
                        <div class="card">
                            <div class="card-header">
                                <div class="section-title" style="margin: 0; font-size: 1rem;">
                                    <i class="fas fa-arrow-up text-success"></i>
                                    <h3 style="font-size: 1rem;">Revenus</h3>
                                </div>
                                <span class="badge badge-success" id="incomeCount">0</span>
                            </div>
                            <div id="incomeCategoriesList" style="font-size: 0.85rem;">
                                <div class="empty-state" style="padding: 1rem;">
                                    <div class="empty-state-icon" style="font-size: 1.5rem;">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                    <p class="empty-state-description" style="font-size: 0.8rem;">
                                        Aucune cat√©gorie de revenus
                                    </p>
                                </div>
                            </div>
                            <div style="margin-top: 0.8rem;">
                                <div style="display: flex; gap: 5px;">
                                    <input type="text" class="form-control" id="newIncomeCategory" placeholder="Nouvelle cat√©gorie" style="flex: 1;">
                                    <button class="btn btn-success btn-icon" id="addIncomeBtn">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- D√©penses -->
                        <div class="card">
                            <div class="card-header">
                                <div class="section-title" style="margin: 0; font-size: 1rem;">
                                    <i class="fas fa-arrow-down text-danger"></i>
                                    <h3 style="font-size: 1rem;">D√©penses</h3>
                                </div>
                                <span class="badge badge-danger" id="expenseCount">0</span>
                            </div>
                            <div id="expenseCategoriesList" style="font-size: 0.85rem;">
                                <div class="empty-state" style="padding: 1rem;">
                                    <div class="empty-state-icon" style="font-size: 1.5rem;">
                                        <i class="fas fa-arrow-down"></i>
                                    </div>
                                    <p class="empty-state-description" style="font-size: 0.8rem;">
                                        Aucune cat√©gorie de d√©penses
                                    </p>
                                </div>
                            </div>
                            <div style="margin-top: 0.8rem;">
                                <div style="display: flex; gap: 5px;">
                                    <input type="text" class="form-control" id="newExpenseCategory" placeholder="Nouvelle cat√©gorie" style="flex: 1;">
                                    <button class="btn btn-success btn-icon" id="addExpenseBtn">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Section Rapports -->
                <section class="content-section" id="reports-section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-chart-bar"></i>
                            <h2>Rapports</h2>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <select class="form-control" id="reportPeriod" style="width: auto;">
                                <option value="month">Ce mois</option>
                                <option value="quarter">Ce trimestre</option>
                                <option value="year">Cette ann√©e</option>
                            </select>
                            <button class="btn btn-primary btn-small" id="exportReportBtn">
                                <i class="fas fa-download"></i>
                                Exporter PDF
                            </button>
                            <button class="btn btn-success btn-small" id="generateReportBtn">
                                <i class="fas fa-chart-bar"></i>
                                G√©n√©rer Rapport
                            </button>
                        </div>
                    </div>
                    
                    <!-- √âtat vierge -->
                    <div id="reportsEmptyState" class="empty-state" style="display: none;">
                        <div class="empty-state-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <h3 class="empty-state-title">Aucune donn√©e pour les rapports</h3>
                        <p class="empty-state-description">
                            Ajoutez des transactions pour g√©n√©rer des rapports et visualiser vos donn√©es financi√®res.
                        </p>
                        <button class="btn btn-primary btn-small" onclick="switchSection('transactions')">
                            <i class="fas fa-plus"></i>
                            Ajouter des transactions
                        </button>
                    </div>
                    
                    <!-- Graphiques -->
                    <div class="charts-grid" id="reportsCharts" style="display: none;">
                        <div class="chart-card">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <i class="fas fa-chart-line"></i>
                                    √âvolution Revenus vs D√©penses
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="incomeExpenseChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-card">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <i class="fas fa-chart-pie"></i>
                                    R√©partition par Cat√©gorie
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="categoryChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tableau d√©taill√© -->
                    <div class="content-section" id="reportsDetailsSection" style="display: none;">
                        <div class="section-header">
                            <div class="section-title">
                                <i class="fas fa-table"></i>
                                <h3>D√©tails par cat√©gorie</h3>
                            </div>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Cat√©gorie</th>
                                        <th>Revenus</th>
                                        <th>D√©penses</th>
                                        <th>Solde</th>
                                        <th>% du total</th>
                                    </tr>
                                </thead>
                                <tbody id="reportDetails">
                                    <!-- Donn√©es dynamiques -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Statistiques d√©taill√©es -->
                    <div class="cards-grid" id="reportsStats" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon" style="background: linear-gradient(135deg, #9B59B6 0%, #8E44AD 100%);">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                                <div class="card-title">Transaction la plus √©lev√©e</div>
                            </div>
                            <div class="card-value" id="highestTransaction">0 FCFA</div>
                            <div class="card-trend">
                                <i class="fas fa-trophy"></i>
                                <span id="highestCategory">-</span>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon" style="background: linear-gradient(135deg, #1ABC9C 0%, #16A085 100%);">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="card-title">Moyenne mensuelle</div>
                            </div>
                            <div class="card-value" id="monthlyAverage">0 FCFA</div>
                            <div class="card-trend">
                                <i class="fas fa-calculator"></i>
                                <span>Par mois</span>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Section Gestionnaires -->
                <section class="content-section" id="users-section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-users"></i>
                            <h2>Gestionnaires</h2>
                        </div>
                        <button class="btn btn-success btn-small" id="newUserBtn">
                            <i class="fas fa-user-plus"></i>
                            Nouveau gestionnaire
                        </button>
                    </div>
                    
                    <div class="cards-grid">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon" style="background: linear-gradient(135deg, var(--info) 0%, #2980B9 100%);">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="card-title">Total gestionnaires</div>
                            </div>
                            <div class="card-value" id="totalUsers">1</div>
                            <div class="card-trend">
                                <i class="fas fa-user-check"></i>
                                <span id="activeUsers">1 actif</span>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-icon" style="background: linear-gradient(135deg, var(--warning) 0%, #D35400 100%);">
                                    <i class="fas fa-user-shield"></i>
                                </div>
                                <div class="card-title">Administrateurs</div>
                            </div>
                            <div class="card-value" id="adminUsers">1</div>
                            <div class="card-trend">
                                <i class="fas fa-crown"></i>
                                <span>Super utilisateurs</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Liste des gestionnaires -->
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Nom & Pr√©nom</th>
                                    <th>Email</th>
                                    <th>R√¥le</th>
                                    <th>Date cr√©ation</th>
                                    <th>Derni√®re connexion</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersList">
                                <!-- Donn√©es dynamiques -->
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- Section Param√®tres -->
                <section class="content-section" id="settings-section">
                    <div class="section-header">
                        <div class="section-title">
                            <i class="fas fa-cog"></i>
                            <h2>Param√®tres</h2>
                        </div>
                    </div>
                    
                    <div class="settings-grid">
                        <!-- Profil utilisateur -->
                        <div class="setting-card">
                            <div class="setting-title">
                                <i class="fas fa-user-circle"></i>
                                <span>Mon profil</span>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Nom</label>
                                <input type="text" class="form-control" id="profileLastName" value="Admin">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Pr√©nom</label>
                                <input type="text" class="form-control" id="profileFirstName" value="Super">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="profileEmail" value="admin@financemaster.tg">
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn btn-primary btn-small" id="updateProfileBtn">
                                    <i class="fas fa-save"></i>
                                    Mettre √† jour
                                </button>
                            </div>
                        </div>
                        
                        <!-- Mot de passe -->
                        <div class="setting-card">
                            <div class="setting-title">
                                <i class="fas fa-lock"></i>
                                <span>Changer le mot de passe</span>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Mot de passe actuel</label>
                                <input type="password" class="form-control" id="currentPassword">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Nouveau mot de passe</label>
                                <input type="password" class="form-control" id="newPassword">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Confirmer</label>
                                <input type="password" class="form-control" id="confirmPassword">
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn btn-warning btn-small" id="changePasswordBtn">
                                    <i class="fas fa-key"></i>
                                    Changer
                                </button>
                            </div>
                        </div>
                        
                        <!-- Pr√©f√©rences -->
                        <div class="setting-card">
                            <div class="setting-title">
                                <i class="fas fa-palette"></i>
                                <span>Pr√©f√©rences</span>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Devise</label>
                                <select class="form-control" id="currencySelect">
                                    <option value="FCFA" selected>Franc CFA (FCFA)</option>
                                    <option value="EUR">Euro (‚Ç¨)</option>
                                    <option value="USD">Dollar US ($)</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Format de date</label>
                                <select class="form-control" id="dateFormatSelect">
                                    <option value="fr-FR" selected>JJ/MM/AAAA</option>
                                    <option value="en-US">MM/DD/AAAA</option>
                                    <option value="en-GB">AAAA-MM-JJ</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Limite de transactions par page</label>
                                <select class="form-control" id="pageLimitSelect">
                                    <option value="10">10</option>
                                    <option value="25" selected>25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn btn-info btn-small" id="savePreferencesBtn">
                                    <i class="fas fa-save"></i>
                                    Enregistrer
                                </button>
                            </div>
                        </div>
                        
                        <!-- R√©initialisation des donn√©es -->
                        <div class="setting-card">
                            <div class="setting-title">
                                <i class="fas fa-database"></i>
                                <span>Gestion des donn√©es</span>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">R√©initialiser toutes les donn√©es</label>
                                <p style="font-size: 0.8rem; color: #666; margin-bottom: 1rem;">
                                    Cette action supprimera toutes les transactions et cat√©gories, mais conservera les comptes utilisateurs.
                                </p>
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn btn-danger btn-small" id="resetAllDataBtn">
                                    <i class="fas fa-trash"></i>
                                    Tout r√©initialiser
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
        
        <!-- Modal Transaction -->
        <div class="modal" id="transactionModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">
                        <i class="fas fa-exchange-alt"></i>
                        <span id="modalTransactionTitle">Nouvelle Transaction</span>
                    </div>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="transactionForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Date</label>
                                <input type="date" class="form-control" id="transactionDate" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Type</label>
                                <select class="form-control" id="transactionType" required>
                                    <option value="">Choisir</option>
                                    <option value="income">Revenu</option>
                                    <option value="expense">D√©pense</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Cat√©gorie</label>
                                <select class="form-control" id="transactionCategory" required>
                                    <option value="">Choisir</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Montant (FCFA)</label>
                                <input type="number" class="form-control" id="transactionAmount" required min="0">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" id="transactionDescription" rows="3" placeholder="Description de la transaction..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-light btn-small modal-close">Annuler</button>
                    <button class="btn btn-success btn-small" id="saveTransactionBtn">
                        <i class="fas fa-save"></i>
                        Enregistrer
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Modal Gestionnaire -->
        <div class="modal" id="userModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">
                        <i class="fas fa-user-plus"></i>
                        <span id="modalUserTitle">Nouveau Gestionnaire</span>
                    </div>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="userForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Nom</label>
                                <input type="text" class="form-control" id="userLastName" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Pr√©nom</label>
                                <input type="text" class="form-control" id="userFirstName" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-control" id="userEmail" required>
                        </div>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Mot de passe</label>
                                <input type="password" class="form-control" id="userPassword" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">R√¥le</label>
                                <select class="form-control" id="userRole" required>
                                    <option value="gestionnaire">Gestionnaire</option>
                                    <option value="administrateur">Administrateur</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-light btn-small modal-close">Annuler</button>
                    <button class="btn btn-success btn-small" id="saveUserBtn">
                        <i class="fas fa-save"></i>
                        Enregistrer
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Notification -->
        <div class="notification" id="notification"></div>
    </div>

    <script>
        // Donn√©es de l'application - COMPTE VIERGE
        const appData = {
            currentUser: null,
            categories: {
                income: [],
                expense: []
            },
            transactions: [],
            users: [
                {
                    id: 1,
                    lastName: 'Admin',
                    firstName: 'Super',
                    email: 'admin@financemaster.tg',
                    password: 'admin123',
                    role: 'administrateur',
                    createdAt: new Date().toISOString().split('T')[0],
                    lastLogin: new Date().toISOString().split('T')[0],
                    isActive: true
                }
            ],
            preferences: {
                currency: 'FCFA',
                dateFormat: 'fr-FR',
                pageLimit: 25
            },
            editingTransactionId: null,
            editingUserId: null,
            currentPage: 1,
            itemsPerPage: 25,
            filteredTransactions: [],
            charts: {}
        };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // V√©rifier si l'utilisateur est d√©j√† connect√©
            const savedUser = localStorage.getItem('financeMasterUser');
            if (savedUser) {
                appData.currentUser = JSON.parse(savedUser);
                showApp();
            } else {
                showLogin();
            }

            setupEventListeners();
            loadInitialData();
        });

        function loadInitialData() {
            // Charger les donn√©es depuis le localStorage ou utiliser les donn√©es vierges
            const savedTransactions = localStorage.getItem('financeMasterTransactions');
            if (savedTransactions) {
                appData.transactions = JSON.parse(savedTransactions);
            }
            
            const savedCategories = localStorage.getItem('financeMasterCategories');
            if (savedCategories) {
                appData.categories = JSON.parse(savedCategories);
            }
            
            const savedUsers = localStorage.getItem('financeMasterUsers');
            if (savedUsers) {
                appData.users = JSON.parse(savedUsers);
            }
            
            const savedPreferences = localStorage.getItem('financeMasterPreferences');
            if (savedPreferences) {
                appData.preferences = JSON.parse(savedPreferences);
                updatePreferencesUI();
            }
        }

        function showLogin() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
        }

        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            
            // Mettre √† jour l'interface utilisateur
            updateUserInterface();
            loadDashboard();
        }

        function setupEventListeners() {
            // Login/Register
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleRegister();
            });
            
            document.getElementById('switchToRegister').addEventListener('click', showRegisterForm);
            document.getElementById('switchToLogin').addEventListener('click', showLoginForm);
            document.getElementById('switchLink').addEventListener('click', function(e) {
                e.preventDefault();
                if (document.getElementById('loginForm').style.display === 'block') {
                    showRegisterForm();
                } else {
                    showLoginForm();
                }
            });

            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    switchSection(this.dataset.section);
                });
            });

            // Boutons principaux
            document.getElementById('quickAddBtn').addEventListener('click', openTransactionModal);
            document.getElementById('newTransactionBtn').addEventListener('click', openTransactionModal);
            document.getElementById('viewAllBtn').addEventListener('click', function() {
                switchSection('transactions');
            });
            document.getElementById('newCategoryBtn').addEventListener('click', function() {
                switchSection('categories');
            });
            document.getElementById('newUserBtn').addEventListener('click', openUserModal);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            document.getElementById('exportBtn').addEventListener('click', exportData);
            document.getElementById('resetDataBtn').addEventListener('click', resetAllData);
            document.getElementById('resetAllDataBtn').addEventListener('click', resetAllData);
            
            // Filtres
            document.getElementById('applyFiltersBtn').addEventListener('click', applyFilters);
            document.getElementById('resetFiltersBtn').addEventListener('click', resetFilters);
            document.getElementById('filterType').addEventListener('change', updateCategoryFilter);
            
            // Modal
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', closeModal);
            });
            
            document.getElementById('saveTransactionBtn').addEventListener('click', saveTransaction);
            document.getElementById('transactionType').addEventListener('change', updateCategoryOptions);
            
            // Cat√©gories
            document.getElementById('addIncomeBtn').addEventListener('click', addIncomeCategory);
            document.getElementById('addExpenseBtn').addEventListener('click', addExpenseCategory);
            
            // Param√®tres
            document.getElementById('updateProfileBtn').addEventListener('click', updateProfile);
            document.getElementById('changePasswordBtn').addEventListener('click', changePassword);
            document.getElementById('savePreferencesBtn').addEventListener('click', savePreferences);
            
            // Rapports
            document.getElementById('reportPeriod').addEventListener('change', loadReports);
            document.getElementById('exportReportBtn').addEventListener('click', exportReport);
            document.getElementById('generateReportBtn').addEventListener('click', generateReport);
            
            // Boutons d'√©tat vierge
            document.getElementById('addFirstTransactionBtn').addEventListener('click', openTransactionModal);
            
            // Menu mobile
            const mobileToggle = document.getElementById('mobileMenuToggle');
            const sidebar = document.getElementById('sidebar');
            
            mobileToggle.addEventListener('click', () => {
                sidebar.classList.toggle('active');
            });
            
            // Fermer menu au clic sur item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    if (window.innerWidth <= 992) {
                        sidebar.classList.remove('active');
                    }
                });
            });
            
            // Fermer modal en cliquant √† l'ext√©rieur
            document.getElementById('transactionModal').addEventListener('click', function(e) {
                if (e.target === this) closeModal();
            });
            
            document.getElementById('userModal').addEventListener('click', function(e) {
                if (e.target === this) closeModal();
            });
            
            // Entr√©e sur les champs de cat√©gorie
            document.getElementById('newIncomeCategory').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    addIncomeCategory();
                }
            });
            
            document.getElementById('newExpenseCategory').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    addExpenseCategory();
                }
            });
        }

        function saveData() {
            localStorage.setItem('financeMasterTransactions', JSON.stringify(appData.transactions));
            localStorage.setItem('financeMasterCategories', JSON.stringify(appData.categories));
            localStorage.setItem('financeMasterUsers', JSON.stringify(appData.users));
            localStorage.setItem('financeMasterPreferences', JSON.stringify(appData.preferences));
        }

        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = appData.users.find(u => u.email === email && u.password === password);
            
            if (user) {
                if (!user.isActive) {
                    showNotification('Ce compte est d√©sactiv√©', 'error');
                    return;
                }
                
                // Mettre √† jour la derni√®re connexion
                user.lastLogin = new Date().toISOString().split('T')[0];
                saveData();
                
                appData.currentUser = {
                    id: user.id,
                    lastName: user.lastName,
                    firstName: user.firstName,
                    email: user.email,
                    role: user.role
                };
                
                // Sauvegarder l'utilisateur connect√©
                localStorage.setItem('financeMasterUser', JSON.stringify(appData.currentUser));
                
                showNotification('Connexion r√©ussie !', 'success');
                setTimeout(() => {
                    showApp();
                }, 1000);
            } else {
                showNotification('Email ou mot de passe incorrect', 'error');
            }
        }

        function handleRegister() {
            const lastName = document.getElementById('registerLastName').value;
            const firstName = document.getElementById('registerFirstName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const role = document.getElementById('registerRole').value;
            
            // Validation
            if (password !== confirmPassword) {
                showNotification('Les mots de passe ne correspondent pas', 'error');
                return;
            }
            
            if (appData.users.some(u => u.email === email)) {
                showNotification('Cet email est d√©j√† utilis√©', 'error');
                return;
            }
            
            // Cr√©er le nouvel utilisateur
            const newUser = {
                id: appData.users.length + 1,
                lastName,
                firstName,
                email,
                password,
                role,
                createdAt: new Date().toISOString().split('T')[0],
                lastLogin: new Date().toISOString().split('T')[0],
                isActive: true
            };
            
            appData.users.push(newUser);
            saveData();
            
            showNotification('Compte cr√©√© avec succ√®s ! Vous pouvez maintenant vous connecter.', 'success');
            showLoginForm();
            
            // R√©initialiser le formulaire
            document.getElementById('registerForm').reset();
        }

        function showLoginForm() {
            document.getElementById('loginTitle').textContent = 'Connexion';
            document.getElementById('loginSubtitle').textContent = 'Acc√©dez √† votre tableau de bord de gestion financi√®re';
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('switchText').textContent = 'Pas encore de compte ? ';
            document.getElementById('switchLink').textContent = 'Cr√©er un compte gestionnaire';
        }

        function showRegisterForm() {
            document.getElementById('loginTitle').textContent = 'Cr√©er un compte';
            document.getElementById('loginSubtitle').textContent = 'Devenez gestionnaire sur FinanceMaster Togo';
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.getElementById('switchText').textContent = 'D√©j√† un compte ? ';
            document.getElementById('switchLink').textContent = 'Se connecter';
        }

        function handleLogout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                localStorage.removeItem('financeMasterUser');
                appData.currentUser = null;
                showNotification('D√©connexion r√©ussie', 'success');
                setTimeout(() => {
                    showLogin();
                }, 1000);
            }
        }

        function updateUserInterface() {
            if (appData.currentUser) {
                const shortName = `${appData.currentUser.lastName} ${appData.currentUser.firstName.charAt(0)}.`;
                
                document.getElementById('userName').textContent = shortName;
                document.getElementById('userRole').textContent = appData.currentUser.role === 'administrateur' ? 'Administrateur' : 'Gestionnaire';
                
                // Initiales pour l'avatar
                const initials = `${appData.currentUser.firstName.charAt(0)}${appData.currentUser.lastName.charAt(0)}`.toUpperCase();
                document.getElementById('userAvatar').textContent = initials;
                
                // Mettre √† jour le profil dans les param√®tres
                document.getElementById('profileLastName').value = appData.currentUser.lastName;
                document.getElementById('profileFirstName').value = appData.currentUser.firstName;
                document.getElementById('profileEmail').value = appData.currentUser.email;
            }
        }

        function updatePreferencesUI() {
            document.getElementById('currencySelect').value = appData.preferences.currency;
            document.getElementById('dateFormatSelect').value = appData.preferences.dateFormat;
            document.getElementById('pageLimitSelect').value = appData.preferences.pageLimit;
            appData.itemsPerPage = appData.preferences.pageLimit;
        }

        function switchSection(section) {
            // Mettre √† jour la navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === section) {
                    item.classList.add('active');
                }
            });
            
            // Mettre √† jour le titre
            const titles = {
                'dashboard': 'Dashboard',
                'transactions': 'Transactions',
                'categories': 'Cat√©gories',
                'reports': 'Rapports',
                'users': 'Gestionnaires',
                'settings': 'Param√®tres'
            };
            
            const icons = {
                'dashboard': 'fa-tachometer-alt',
                'transactions': 'fa-exchange-alt',
                'categories': 'fa-tags',
                'reports': 'fa-chart-bar',
                'users': 'fa-users',
                'settings': 'fa-cog'
            };
            
            document.querySelector('.page-title h1').textContent = titles[section];
            document.querySelector('.page-title i').className = `fas ${icons[section]}`;
            
            // Afficher la section correspondante
            document.querySelectorAll('.content-section').forEach(sec => {
                sec.classList.remove('active');
            });
            
            const activeSection = document.getElementById(`${section}-section`);
            if (activeSection) {
                activeSection.classList.add('active');
                loadSection(section);
            }
        }

        function loadSection(section) {
            switch(section) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'transactions':
                    loadTransactions();
                    break;
                case 'categories':
                    loadCategories();
                    break;
                case 'reports':
                    loadReports();
                    break;
                case 'users':
                    loadUsers();
                    break;
                case 'settings':
                    loadSettings();
                    break;
            }
        }

        function loadDashboard() {
            // Calculer les statistiques
            const income = appData.transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const expense = appData.transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const balance = income - expense;
            const totalTransactions = appData.transactions.length;
            
            // Mettre √† jour les statistiques
            document.getElementById('totalIncome').textContent = `${formatCurrency(income)}`;
            document.getElementById('totalExpense').textContent = `${formatCurrency(expense)}`;
            document.getElementById('totalBalance').textContent = `${formatCurrency(balance)}`;
            document.getElementById('totalTransactions').textContent = totalTransactions;
            
            // Calculer les tendances
            document.getElementById('incomeTrend').textContent = '+0%';
            document.getElementById('expenseTrend').textContent = '-0%';
            
            // Calculer les transactions du mois
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const monthlyTransactions = appData.transactions.filter(t => {
                const date = new Date(t.date);
                return date.getMonth() === currentMonth && date.getFullYear() === currentYear;
            }).length;
            
            document.getElementById('transactionCount').textContent = `Ce mois: ${monthlyTransactions}`;
            
            // Mettre √† jour la barre de progression
            const total = income + expense;
            const progressPercent = total > 0 ? (income / total) * 100 : 50;
            document.getElementById('balanceProgress').style.width = `${progressPercent}%`;
            
            // Graphique mensuel
            createMonthlyChart();
            
            // Graphique des d√©penses
            createExpenseChart();
            
            // Transactions r√©centes
            loadRecentTransactions();
        }

        function createMonthlyChart() {
            // D√©truire le graphique existant
            if (appData.charts.monthly) {
                appData.charts.monthly.destroy();
            }
            
            // Calculer les donn√©es mensuelles
            const monthlyData = calculateMonthlyData();
            
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            appData.charts.monthly = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthlyData.labels,
                    datasets: [{
                        label: 'Revenus',
                        data: monthlyData.income,
                        borderColor: '#008751',
                        backgroundColor: 'rgba(0,135,81,0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 2
                    },
                    {
                        label: 'D√©penses',
                        data: monthlyData.expense,
                        borderColor: '#D21034',
                        backgroundColor: 'rgba(210,16,52,0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    family: 'Montserrat',
                                    size: 12
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
        }

        function createExpenseChart() {
            // D√©truire le graphique existant
            if (appData.charts.expense) {
                appData.charts.expense.destroy();
            }
            
            // Calculer les d√©penses par cat√©gorie
            const expenseData = {};
            appData.transactions.filter(t => t.type === 'expense').forEach(t => {
                expenseData[t.category] = (expenseData[t.category] || 0) + t.amount;
            });
            
            const categories = Object.keys(expenseData);
            const amounts = Object.values(expenseData);
            
            if (categories.length === 0) {
                document.getElementById('expenseChart').parentElement.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">
                        <div style="text-align: center;">
                            <i class="fas fa-chart-pie" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <p>Aucune donn√©e de d√©penses disponible</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            const ctx = document.getElementById('expenseChart').getContext('2d');
            appData.charts.expense = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categories,
                    datasets: [{
                        data: amounts,
                        backgroundColor: [
                            '#008751', '#FFD100', '#D21034', '#006442', 
                            '#2ECC71', '#E74C3C', '#F39C12', '#3498DB',
                            '#9B59B6', '#1ABC9C', '#34495E', '#95A5A6'
                        ],
                        borderWidth: 1,
                        borderColor: 'white'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                font: {
                                    family: 'Montserrat',
                                    size: 11
                                },
                                padding: 15
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${formatCurrency(value)} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function calculateMonthlyData() {
            const months = ['Jan', 'F√©v', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Ao√ªt', 'Sept', 'Oct', 'Nov', 'D√©c'];
            const currentMonth = new Date().getMonth();
            
            // Prendre les 6 derniers mois
            const labels = [];
            const incomeData = [];
            const expenseData = [];
            
            for (let i = 5; i >= 0; i--) {
                const monthIndex = (currentMonth - i + 12) % 12;
                labels.push(months[monthIndex]);
                incomeData.push(0);
                expenseData.push(0);
            }
            
            return { labels, income: incomeData, expense: expenseData };
        }

        function loadRecentTransactions() {
            const recentContainer = document.getElementById('recentTransactions');
            
            if (appData.transactions.length === 0) {
                recentContainer.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 2rem; color: #666;">
                            <div class="empty-state" style="padding: 0;">
                                <div class="empty-state-icon" style="font-size: 2rem;">
                                    <i class="fas fa-exchange-alt"></i>
                                </div>
                                <h4 class="empty-state-title" style="font-size: 1rem;">Aucune transaction</h4>
                                <p class="empty-state-description" style="font-size: 0.85rem;">
                                    Commencez par ajouter votre premi√®re transaction
                                </p>
                            </div>
                        </td>
                    </tr>
                `;
            } else {
                const recentTransactions = appData.transactions
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 5);
                
                recentContainer.innerHTML = '';
                
                recentTransactions.forEach(trans => {
                    const row = document.createElement('tr');
                    const date = new Date(trans.date).toLocaleDateString(appData.preferences.dateFormat);
                    const amountClass = trans.type === 'income' ? 'text-success' : 'text-danger';
                    const amountSign = trans.type === 'income' ? '+' : '-';
                    const badgeClass = trans.type === 'income' ? 'badge-success' : 'badge-danger';
                    
                    row.innerHTML = `
                        <td>${date}</td>
                        <td>${trans.description}</td>
                        <td><span class="badge ${badgeClass}">${trans.category}</span></td>
                        <td class="${amountClass} font-weight-bold">${amountSign} ${formatCurrency(trans.amount)}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon" onclick="editTransaction(${trans.id})" title="Modifier">
                                    <i class="fas fa-edit"></i>
                                </button>
                                ${appData.currentUser.role === 'administrateur' ? `
                                <button class="btn-icon" style="background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%);" onclick="deleteTransaction(${trans.id})" title="Supprimer">
                                    <i class="fas fa-trash"></i>
                                </button>` : ''}
                            </div>
                        </td>
                    `;
                    recentContainer.appendChild(row);
                });
            }
        }

        function loadTransactions() {
            if (appData.transactions.length === 0) {
                // Afficher l'√©tat vierge
                document.getElementById('transactionsEmptyState').style.display = 'block';
                document.getElementById('transactionsFilters').style.display = 'none';
                document.getElementById('transactionsTable').style.display = 'none';
                document.getElementById('transactionsPagination').style.display = 'none';
            } else {
                // Cacher l'√©tat vierge
                document.getElementById('transactionsEmptyState').style.display = 'none';
                document.getElementById('transactionsFilters').style.display = 'block';
                document.getElementById('transactionsTable').style.display = 'block';
                
                // Initialiser les filtres
                const today = new Date().toISOString().split('T')[0];
                const monthAgo = new Date();
                monthAgo.setMonth(monthAgo.getMonth() - 1);
                const monthAgoStr = monthAgo.toISOString().split('T')[0];
                
                document.getElementById('filterStartDate').value = monthAgoStr;
                document.getElementById('filterEndDate').value = today;
                
                // Mettre √† jour les options de cat√©gories pour le filtre
                updateCategoryFilter();
                
                // Appliquer les filtres
                applyFilters();
            }
        }

        function applyFilters() {
            let filtered = [...appData.transactions];
            
            // Filtrer par date
            const startDate = document.getElementById('filterStartDate').value;
            const endDate = document.getElementById('filterEndDate').value;
            
            if (startDate) {
                filtered = filtered.filter(t => new Date(t.date) >= new Date(startDate));
            }
            if (endDate) {
                filtered = filtered.filter(t => new Date(t.date) <= new Date(endDate));
            }
            
            // Filtrer par type
            const type = document.getElementById('filterType').value;
            if (type) {
                filtered = filtered.filter(t => t.type === type);
            }
            
            // Filtrer par cat√©gorie
            const category = document.getElementById('filterCategory').value;
            if (category) {
                filtered = filtered.filter(t => t.category === category);
            }
            
            // Filtrer par montant minimum
            const minAmount = document.getElementById('filterMinAmount').value;
            if (minAmount) {
                filtered = filtered.filter(t => t.amount >= parseFloat(minAmount));
            }
            
            appData.filteredTransactions = filtered;
            appData.currentPage = 1;
            renderTransactions();
            
            if (filtered.length === 0) {
                showNotification('Aucune transaction correspondant aux crit√®res', 'warning');
            } else {
                showNotification(`${filtered.length} transaction(s) trouv√©e(s)`, 'success');
            }
        }

        function resetFilters() {
            // R√©initialiser tous les filtres
            const today = new Date().toISOString().split('T')[0];
            const monthAgo = new Date();
            monthAgo.setMonth(monthAgo.getMonth() - 1);
            const monthAgoStr = monthAgo.toISOString().split('T')[0];
            
            document.getElementById('filterStartDate').value = monthAgoStr;
            document.getElementById('filterEndDate').value = today;
            document.getElementById('filterType').value = '';
            document.getElementById('filterCategory').value = '';
            document.getElementById('filterMinAmount').value = '';
            
            // R√©appliquer les filtres
            applyFilters();
        }

        function updateCategoryFilter() {
            const type = document.getElementById('filterType').value;
            const select = document.getElementById('filterCategory');
            select.innerHTML = '<option value="">Toutes</option>';
            
            let categories = [];
            if (type === 'income') {
                categories = appData.categories.income;
            } else if (type === 'expense') {
                categories = appData.categories.expense;
            } else {
                categories = [...appData.categories.income, ...appData.categories.expense];
            }
            
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                select.appendChild(option);
            });
        }

        function renderTransactions() {
            const container = document.getElementById('transactionsList');
            container.innerHTML = '';
            
            // Pagination
            const startIndex = (appData.currentPage - 1) * appData.itemsPerPage;
            const endIndex = startIndex + appData.itemsPerPage;
            const paginatedTransactions = appData.filteredTransactions.slice(startIndex, endIndex);
            const totalPages = Math.ceil(appData.filteredTransactions.length / appData.itemsPerPage);
            
            if (paginatedTransactions.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 2rem; color: #666;">
                            Aucune transaction correspondant aux crit√®res
                        </td>
                    </tr>
                `;
            } else {
                // Rendre les transactions
                paginatedTransactions.forEach(trans => {
                    const row = document.createElement('tr');
                    const date = new Date(trans.date).toLocaleDateString(appData.preferences.dateFormat);
                    const amountClass = trans.type === 'income' ? 'text-success' : 'text-danger';
                    const amountSign = trans.type === 'income' ? '+' : '-';
                    const badgeClass = trans.type === 'income' ? 'badge-success' : 'badge-danger';
                    const typeText = trans.type === 'income' ? 'Revenu' : 'D√©pense';
                    
                    row.innerHTML = `
                        <td>${date}</td>
                        <td>${trans.description}</td>
                        <td>${trans.category}</td>
                        <td><span class="badge ${badgeClass}">${typeText}</span></td>
                        <td class="${amountClass} font-weight-bold">${amountSign} ${formatCurrency(trans.amount)}</td>
                        <td>${trans.createdBy}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon" onclick="editTransaction(${trans.id})" title="Modifier">
                                    <i class="fas fa-edit"></i>
                                </button>
                                ${appData.currentUser.role === 'administrateur' ? `
                                <button class="btn-icon" style="background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%);" onclick="deleteTransaction(${trans.id})" title="Supprimer">
                                    <i class="fas fa-trash"></i>
                                </button>` : ''}
                            </div>
                        </td>
                    `;
                    container.appendChild(row);
                });
            }
            
            // Mettre √† jour la pagination
            const paginationContainer = document.getElementById('transactionsPagination');
            paginationContainer.innerHTML = '';
            paginationContainer.style.display = totalPages > 1 ? 'flex' : 'none';
            
            if (totalPages > 1) {
                renderPagination('transactionsPagination', totalPages, (page) => {
                    appData.currentPage = page;
                    renderTransactions();
                });
            }
        }

        function renderPagination(containerId, totalPages, onPageChange) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // Bouton pr√©c√©dent
            if (appData.currentPage > 1) {
                const prevBtn = document.createElement('a');
                prevBtn.className = 'page-link';
                prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
                prevBtn.addEventListener('click', () => {
                    onPageChange(appData.currentPage - 1);
                });
                container.appendChild(prevBtn);
            }
            
            // Pages
            const maxVisiblePages = 5;
            let startPage = Math.max(1, appData.currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('a');
                pageBtn.className = 'page-link';
                if (i === appData.currentPage) {
                    pageBtn.classList.add('active');
                }
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', () => {
                    onPageChange(i);
                });
                container.appendChild(pageBtn);
            }
            
            // Bouton suivant
            if (appData.currentPage < totalPages) {
                const nextBtn = document.createElement('a');
                nextBtn.className = 'page-link';
                nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
                nextBtn.addEventListener('click', () => {
                    onPageChange(appData.currentPage + 1);
                });
                container.appendChild(nextBtn);
            }
        }

        function loadCategories() {
            // Mettre √† jour les compteurs
            document.getElementById('incomeCount').textContent = appData.categories.income.length;
            document.getElementById('expenseCount').textContent = appData.categories.expense.length;
            
            // Rendre les cat√©gories de revenus
            const incomeList = document.getElementById('incomeCategoriesList');
            incomeList.innerHTML = '';
            
            if (appData.categories.income.length === 0) {
                incomeList.innerHTML = `
                    <div class="empty-state" style="padding: 1rem;">
                        <div class="empty-state-icon" style="font-size: 1.5rem;">
                            <i class="fas fa-arrow-up"></i>
                        </div>
                        <p class="empty-state-description" style="font-size: 0.8rem;">
                            Aucune cat√©gorie de revenus
                        </p>
                    </div>
                `;
            } else {
                appData.categories.income.forEach(cat => {
                    const div = document.createElement('div');
                    div.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid #eee;';
                    
                    // Compter les transactions pour cette cat√©gorie
                    const transactionCount = appData.transactions.filter(t => t.category === cat && t.type === 'income').length;
                    
                    div.innerHTML = `
                        <div>
                            <span>${cat}</span>
                            <span style="font-size: 0.7rem; color: #666; margin-left: 0.5rem;">
                                (${transactionCount} transaction${transactionCount !== 1 ? 's' : ''})
                            </span>
                        </div>
                        <div>
                            ${appData.currentUser.role === 'administrateur' ? `
                            <button class="btn-icon" onclick="editCategory('income', '${cat}')" title="Modifier" style="width: 30px; height: 30px; font-size: 0.8rem;">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon" onclick="deleteCategory('income', '${cat}')" title="Supprimer" style="width: 30px; height: 30px; font-size: 0.8rem; background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%); margin-left: 4px;">
                                <i class="fas fa-trash"></i>
                            </button>` : ''}
                        </div>
                    `;
                    incomeList.appendChild(div);
                });
            }
            
            // Rendre les cat√©gories de d√©penses
            const expenseList = document.getElementById('expenseCategoriesList');
            expenseList.innerHTML = '';
            
            if (appData.categories.expense.length === 0) {
                expenseList.innerHTML = `
                    <div class="empty-state" style="padding: 1rem;">
                        <div class="empty-state-icon" style="font-size: 1.5rem;">
                            <i class="fas fa-arrow-down"></i>
                        </div>
                        <p class="empty-state-description" style="font-size: 0.8rem;">
                            Aucune cat√©gorie de d√©penses
                        </p>
                    </div>
                `;
            } else {
                appData.categories.expense.forEach(cat => {
                    const div = document.createElement('div');
                    div.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid #eee;';
                    
                    // Compter les transactions pour cette cat√©gorie
                    const transactionCount = appData.transactions.filter(t => t.category === cat && t.type === 'expense').length;
                    
                    div.innerHTML = `
                        <div>
                            <span>${cat}</span>
                            <span style="font-size: 0.7rem; color: #666; margin-left: 0.5rem;">
                                (${transactionCount} transaction${transactionCount !== 1 ? 's' : ''})
                            </span>
                        </div>
                        <div>
                            ${appData.currentUser.role === 'administrateur' ? `
                            <button class="btn-icon" onclick="editCategory('expense', '${cat}')" title="Modifier" style="width: 30px; height: 30px; font-size: 0.8rem;">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon" onclick="deleteCategory('expense', '${cat}')" title="Supprimer" style="width: 30px; height: 30px; font-size: 0.8rem; background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%); margin-left: 4px;">
                                <i class="fas fa-trash"></i>
                            </button>` : ''}
                        </div>
                    `;
                    expenseList.appendChild(div);
                });
            }
        }

        function addIncomeCategory() {
            const input = document.getElementById('newIncomeCategory');
            const cat = input.value.trim();
            
            if (cat && !appData.categories.income.includes(cat)) {
                appData.categories.income.push(cat);
                input.value = '';
                saveData();
                loadCategories();
                showNotification('Cat√©gorie de revenu ajout√©e', 'success');
            } else if (appData.categories.income.includes(cat)) {
                showNotification('Cette cat√©gorie existe d√©j√†', 'error');
            } else {
                showNotification('Veuillez entrer un nom de cat√©gorie', 'error');
            }
        }

        function addExpenseCategory() {
            const input = document.getElementById('newExpenseCategory');
            const cat = input.value.trim();
            
            if (cat && !appData.categories.expense.includes(cat)) {
                appData.categories.expense.push(cat);
                input.value = '';
                saveData();
                loadCategories();
                showNotification('Cat√©gorie de d√©pense ajout√©e', 'success');
            } else if (appData.categories.expense.includes(cat)) {
                showNotification('Cette cat√©gorie existe d√©j√†', 'error');
            } else {
                showNotification('Veuillez entrer un nom de cat√©gorie', 'error');
            }
        }

        function loadReports() {
            if (appData.transactions.length === 0) {
                // Afficher l'√©tat vierge
                document.getElementById('reportsEmptyState').style.display = 'block';
                document.getElementById('reportsCharts').style.display = 'none';
                document.getElementById('reportsDetailsSection').style.display = 'none';
                document.getElementById('reportsStats').style.display = 'none';
            } else {
                // Cacher l'√©tat vierge
                document.getElementById('reportsEmptyState').style.display = 'none';
                document.getElementById('reportsCharts').style.display = 'grid';
                document.getElementById('reportsDetailsSection').style.display = 'block';
                document.getElementById('reportsStats').style.display = 'grid';
                
                // G√©n√©rer le rapport
                generateReport();
            }
        }

        function generateReport() {
            const period = document.getElementById('reportPeriod').value;
            
            // Calculer les donn√©es selon la p√©riode
            const reportData = calculateReportData(period);
            
            // Mettre √† jour les statistiques
            document.getElementById('highestTransaction').textContent = formatCurrency(reportData.highestTransaction.amount);
            document.getElementById('highestCategory').textContent = reportData.highestTransaction.category;
            document.getElementById('monthlyAverage').textContent = formatCurrency(reportData.monthlyAverage);
            
            // Cr√©er le graphique revenus vs d√©penses
            createIncomeExpenseChart(reportData);
            
            // Cr√©er le graphique par cat√©gorie
            createCategoryChart(reportData);
            
            // Mettre √† jour le tableau d√©taill√©
            updateReportDetails(reportData);
            
            showNotification('Rapport g√©n√©r√© avec succ√®s', 'success');
        }

        function calculateReportData(period) {
            const now = new Date();
            let startDate, endDate;
            
            switch(period) {
                case 'month':
                    startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                    endDate = new Date(now.getFullYear(), now.getMonth() + 1, 0);
                    break;
                case 'quarter':
                    const quarter = Math.floor(now.getMonth() / 3);
                    startDate = new Date(now.getFullYear(), quarter * 3, 1);
                    endDate = new Date(now.getFullYear(), (quarter + 1) * 3, 0);
                    break;
                case 'year':
                    startDate = new Date(now.getFullYear(), 0, 1);
                    endDate = new Date(now.getFullYear(), 11, 31);
                    break;
            }
            
            // Filtrer les transactions par p√©riode
            const filteredTransactions = appData.transactions.filter(t => {
                const date = new Date(t.date);
                return date >= startDate && date <= endDate;
            });
            
            // Calculer les statistiques
            const income = filteredTransactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const expense = filteredTransactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
            
            // Trouver la transaction la plus √©lev√©e
            const highestTransaction = filteredTransactions.length > 0 ? 
                filteredTransactions.reduce((max, t) => t.amount > max.amount ? t : max, filteredTransactions[0]) : 
                { amount: 0, category: '-' };
            
            // Calculer la moyenne mensuelle
            const months = period === 'year' ? 12 : period === 'quarter' ? 3 : 1;
            const monthlyAverage = (income + expense) / months;
            
            // Regrouper par cat√©gorie
            const categoryData = {};
            filteredTransactions.forEach(t => {
                if (!categoryData[t.category]) {
                    categoryData[t.category] = { income: 0, expense: 0 };
                }
                if (t.type === 'income') {
                    categoryData[t.category].income += t.amount;
                } else {
                    categoryData[t.category].expense += t.amount;
                }
            });
            
            // Donn√©es pour le graphique temporel
            const monthsLabels = [];
            const incomeData = [];
            const expenseData = [];
            
            let currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                const monthLabel = currentDate.toLocaleDateString('fr-FR', { month: 'short' });
                monthsLabels.push(monthLabel);
                
                const monthIncome = filteredTransactions
                    .filter(t => t.type === 'income' && 
                        new Date(t.date).getMonth() === currentDate.getMonth() &&
                        new Date(t.date).getFullYear() === currentDate.getFullYear())
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const monthExpense = filteredTransactions
                    .filter(t => t.type === 'expense' && 
                        new Date(t.date).getMonth() === currentDate.getMonth() &&
                        new Date(t.date).getFullYear() === currentDate.getFullYear())
                    .reduce((sum, t) => sum + t.amount, 0);
                
                incomeData.push(monthIncome);
                expenseData.push(monthExpense);
                
                currentDate.setMonth(currentDate.getMonth() + 1);
            }
            
            return {
                income,
                expense,
                highestTransaction,
                monthlyAverage,
                categoryData,
                monthsLabels,
                incomeData,
                expenseData,
                filteredTransactions
            };
        }

        function createIncomeExpenseChart(reportData) {
            // D√©truire le graphique existant
            if (appData.charts.incomeExpense) {
                appData.charts.incomeExpense.destroy();
            }
            
            const ctx = document.getElementById('incomeExpenseChart').getContext('2d');
            appData.charts.incomeExpense = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: reportData.monthsLabels,
                    datasets: [
                        {
                            label: 'Revenus',
                            data: reportData.incomeData,
                            backgroundColor: '#008751',
                            borderColor: '#008751',
                            borderWidth: 1
                        },
                        {
                            label: 'D√©penses',
                            data: reportData.expenseData,
                            backgroundColor: '#D21034',
                            borderColor: '#D21034',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
        }

        function createCategoryChart(reportData) {
            // D√©truire le graphique existant
            if (appData.charts.category) {
                appData.charts.category.destroy();
            }
            
            const categories = Object.keys(reportData.categoryData);
            const incomeData = categories.map(cat => reportData.categoryData[cat].income);
            const expenseData = categories.map(cat => reportData.categoryData[cat].expense);
            
            if (categories.length === 0) {
                document.getElementById('categoryChart').parentElement.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">
                        <div style="text-align: center;">
                            <i class="fas fa-chart-bar" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                            <p>Aucune donn√©e de cat√©gorie disponible</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            const ctx = document.getElementById('categoryChart').getContext('2d');
            appData.charts.category = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categories,
                    datasets: [
                        {
                            label: 'Revenus',
                            data: incomeData,
                            backgroundColor: '#008751'
                        },
                        {
                            label: 'D√©penses',
                            data: expenseData,
                            backgroundColor: '#D21034'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateReportDetails(reportData) {
            const detailsContainer = document.getElementById('reportDetails');
            detailsContainer.innerHTML = '';
            
            const categories = Object.keys(reportData.categoryData);
            
            if (categories.length === 0) {
                detailsContainer.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 2rem; color: #666;">
                            Aucune donn√©e disponible pour cette p√©riode
                        </td>
                    </tr>
                `;
                return;
            }
            
            let totalIncome = 0;
            let totalExpense = 0;
            
            categories.forEach(category => {
                const row = document.createElement('tr');
                const totals = reportData.categoryData[category];
                const balance = totals.income - totals.expense;
                const total = totals.income + totals.expense;
                const percentage = total > 0 ? ((totals.income + totals.expense) / (reportData.income + reportData.expense) * 100).toFixed(1) : '0.0';
                
                totalIncome += totals.income;
                totalExpense += totals.expense;
                
                row.innerHTML = `
                    <td>${category}</td>
                    <td class="text-success font-weight-bold">${formatCurrency(totals.income)}</td>
                    <td class="text-danger font-weight-bold">${formatCurrency(totals.expense)}</td>
                    <td class="${balance >= 0 ? 'text-success' : 'text-danger'} font-weight-bold">${formatCurrency(balance)}</td>
                    <td>${percentage}%</td>
                `;
                detailsContainer.appendChild(row);
            });
            
            // Ligne des totaux
            const totalRow = document.createElement('tr');
            totalRow.style.cssText = 'background: var(--togo-light); font-weight: bold;';
            const totalBalance = totalIncome - totalExpense;
            
            totalRow.innerHTML = `
                <td>TOTAL</td>
                <td class="text-success">${formatCurrency(totalIncome)}</td>
                <td class="text-danger">${formatCurrency(totalExpense)}</td>
                <td class="${totalBalance >= 0 ? 'text-success' : 'text-danger'}">${formatCurrency(totalBalance)}</td>
                <td>100%</td>
            `;
            detailsContainer.appendChild(totalRow);
        }

        function exportReport() {
            if (appData.transactions.length === 0) {
                showNotification('Aucune donn√©e √† exporter', 'warning');
                return;
            }
            
            // Simuler l'exportation PDF
            showNotification('Rapport PDF g√©n√©r√© avec succ√®s', 'success');
            
            // Dans une vraie application, on utiliserait une biblioth√®que comme jsPDF
            // Pour l'instant, on simule juste le t√©l√©chargement
            setTimeout(() => {
                const link = document.createElement('a');
                link.href = '#';
                link.download = `rapport-financemaster-${new Date().toISOString().split('T')[0]}.pdf`;
                link.click();
            }, 1000);
        }

        function exportData() {
            if (appData.transactions.length === 0 && 
                appData.categories.income.length === 0 && 
                appData.categories.expense.length === 0) {
                showNotification('Aucune donn√©e √† exporter', 'warning');
                return;
            }
            
            // Exporter les donn√©es en JSON
            const data = {
                transactions: appData.transactions,
                categories: appData.categories,
                users: appData.users,
                preferences: appData.preferences,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const link = document.createElement('a');
            link.href = dataUri;
            link.download = `financemaster-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showNotification('Donn√©es export√©es avec succ√®s', 'success');
        }

        function resetAllData() {
            if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser toutes les donn√©es ?\n\nCette action supprimera toutes les transactions et cat√©gories, mais conservera les comptes utilisateurs.\n\nCette action est irr√©versible.')) {
                // R√©initialiser les donn√©es
                appData.transactions = [];
                appData.categories = {
                    income: [],
                    expense: []
                };
                appData.filteredTransactions = [];
                appData.currentPage = 1;
                
                // Sauvegarder les donn√©es
                saveData();
                
                // Recharger les sections
                loadDashboard();
                loadTransactions();
                loadCategories();
                loadReports();
                
                showNotification('Toutes les donn√©es ont √©t√© r√©initialis√©es', 'success');
            }
        }

        function loadUsers() {
            // Mettre √† jour les statistiques
            const totalUsers = appData.users.length;
            const adminUsers = appData.users.filter(u => u.role === 'administrateur').length;
            const activeUsers = appData.users.filter(u => u.isActive).length;
            
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('adminUsers').textContent = adminUsers;
            document.getElementById('activeUsers').textContent = `${activeUsers} actifs`;
            
            // Rendre la liste des utilisateurs
            const container = document.getElementById('usersList');
            container.innerHTML = '';
            
            if (appData.users.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 2rem; color: #666;">
                            Aucun utilisateur enregistr√©
                        </td>
                    </tr>
                `;
            } else {
                appData.users.forEach(user => {
                    const row = document.createElement('tr');
                    const statusClass = user.isActive ? 'badge-success' : 'badge-danger';
                    const statusText = user.isActive ? 'Actif' : 'Inactif';
                    const roleClass = user.role === 'administrateur' ? 'badge-warning' : 'badge-info';
                    const roleText = user.role === 'administrateur' ? 'Administrateur' : 'Gestionnaire';
                    
                    row.innerHTML = `
                        <td>${user.lastName} ${user.firstName}</td>
                        <td>${user.email}</td>
                        <td><span class="badge ${roleClass}">${roleText}</span></td>
                        <td>${user.createdAt}</td>
                        <td>${user.lastLogin}</td>
                        <td><span class="badge ${statusClass}">${statusText}</span></td>
                        <td>
                            <div class="action-buttons">
                                ${appData.currentUser.role === 'administrateur' && appData.currentUser.id !== user.id ? `
                                <button class="btn-icon" onclick="editUser(${user.id})" title="Modifier">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-icon" style="background: linear-gradient(135deg, ${user.isActive ? 'var(--warning)' : 'var(--success)'} 0%, ${user.isActive ? '#D35400' : '#219653'} 100%);" onclick="toggleUserStatus(${user.id})" title="${user.isActive ? 'D√©sactiver' : 'Activer'}">
                                    <i class="fas ${user.isActive ? 'fa-user-slash' : 'fa-user-check'}"></i>
                                </button>
                                <button class="btn-icon" style="background: linear-gradient(135deg, var(--togo-red) 0%, #B80E2C 100%);" onclick="deleteUser(${user.id})" title="Supprimer">
                                    <i class="fas fa-trash"></i>
                                </button>` : ''}
                            </div>
                        </td>
                    `;
                    container.appendChild(row);
                });
            }
        }

        function loadSettings() {
            // Les param√®tres sont d√©j√† charg√©s dans updatePreferencesUI
        }

        function openTransactionModal() {
            appData.editingTransactionId = null;
            document.getElementById('modalTransactionTitle').textContent = 'Nouvelle Transaction';
            document.getElementById('transactionForm').reset();
            
            // D√©finir la date par d√©faut
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('transactionDate').value = today;
            
            updateCategoryOptions();
            document.getElementById('transactionModal').classList.add('active');
        }

        function openUserModal() {
            appData.editingUserId = null;
            document.getElementById('modalUserTitle').textContent = 'Nouveau Gestionnaire';
            document.getElementById('userForm').reset();
            document.getElementById('userModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('transactionModal').classList.remove('active');
            document.getElementById('userModal').classList.remove('active');
        }

        function updateCategoryOptions() {
            const type = document.getElementById('transactionType').value;
            const select = document.getElementById('transactionCategory');
            select.innerHTML = '<option value="">Choisir</option>';
            
            if (type === 'income') {
                appData.categories.income.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat;
                    option.textContent = cat;
                    select.appendChild(option);
                });
            } else if (type === 'expense') {
                appData.categories.expense.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat;
                    option.textContent = cat;
                    select.appendChild(option);
                });
            }
        }

        function saveTransaction() {
            const form = document.getElementById('transactionForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const transactionData = {
                date: document.getElementById('transactionDate').value,
                type: document.getElementById('transactionType').value,
                category: document.getElementById('transactionCategory').value,
                amount: parseFloat(document.getElementById('transactionAmount').value),
                description: document.getElementById('transactionDescription').value || 'Transaction',
                createdBy: `${appData.currentUser.firstName} ${appData.currentUser.lastName}`,
                createdAt: new Date().toISOString()
            };
            
            if (appData.editingTransactionId) {
                // Mettre √† jour la transaction existante
                const index = appData.transactions.findIndex(t => t.id === appData.editingTransactionId);
                if (index !== -1) {
                    appData.transactions[index] = { ...appData.transactions[index], ...transactionData };
                    showNotification('Transaction modifi√©e', 'success');
                }
            } else {
                // Cr√©er une nouvelle transaction
                const newTransaction = {
                    id: appData.transactions.length > 0 ? Math.max(...appData.transactions.map(t => t.id)) + 1 : 1,
                    ...transactionData
                };
                appData.transactions.push(newTransaction);
                showNotification('Transaction enregistr√©e', 'success');
            }
            
            saveData();
            closeModal();
            
            // Recharger la section active
            const activeSection = document.querySelector('.content-section.active').id.replace('-section', '');
            loadSection(activeSection);
        }

        function saveUser() {
            const form = document.getElementById('userForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            const userData = {
                lastName: document.getElementById('userLastName').value,
                firstName: document.getElementById('userFirstName').value,
                email: document.getElementById('userEmail').value,
                password: document.getElementById('userPassword').value,
                role: document.getElementById('userRole').value
            };
            
            if (appData.editingUserId) {
                // Mettre √† jour l'utilisateur existant
                const index = appData.users.findIndex(u => u.id === appData.editingUserId);
                if (index !== -1) {
                    appData.users[index] = { ...appData.users[index], ...userData };
                    showNotification('Gestionnaire modifi√©', 'success');
                }
            } else {
                // V√©rifier si l'email existe d√©j√†
                if (appData.users.some(u => u.email === userData.email)) {
                    showNotification('Cet email est d√©j√† utilis√©', 'error');
                    return;
                }
                
                // Cr√©er un nouvel utilisateur
                const newUser = {
                    id: appData.users.length > 0 ? Math.max(...appData.users.map(u => u.id)) + 1 : 1,
                    ...userData,
                    createdAt: new Date().toISOString().split('T')[0],
                    lastLogin: new Date().toISOString().split('T')[0],
                    isActive: true
                };
                appData.users.push(newUser);
                showNotification('Gestionnaire cr√©√©', 'success');
            }
            
            saveData();
            closeModal();
            loadUsers();
        }

        function updateProfile() {
            const lastName = document.getElementById('profileLastName').value;
            const firstName = document.getElementById('profileFirstName').value;
            const email = document.getElementById('profileEmail').value;
            
            // Mettre √† jour l'utilisateur courant
            appData.currentUser.lastName = lastName;
            appData.currentUser.firstName = firstName;
            appData.currentUser.email = email;
            
            // Mettre √† jour dans la liste des utilisateurs
            const userIndex = appData.users.findIndex(u => u.id === appData.currentUser.id);
            if (userIndex !== -1) {
                appData.users[userIndex].lastName = lastName;
                appData.users[userIndex].firstName = firstName;
                appData.users[userIndex].email = email;
            }
            
            saveData();
            updateUserInterface();
            showNotification('Profil mis √† jour', 'success');
        }

        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // V√©rifier le mot de passe actuel
            const user = appData.users.find(u => u.id === appData.currentUser.id);
            if (!user || user.password !== currentPassword) {
                showNotification('Mot de passe actuel incorrect', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showNotification('Les nouveaux mots de passe ne correspondent pas', 'error');
                return;
            }
            
            // Mettre √† jour le mot de passe
            user.password = newPassword;
            saveData();
            
            // R√©initialiser le formulaire
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            
            showNotification('Mot de passe chang√© avec succ√®s', 'success');
        }

        function savePreferences() {
            const newPreferences = {
                currency: document.getElementById('currencySelect').value,
                dateFormat: document.getElementById('dateFormatSelect').value,
                pageLimit: parseInt(document.getElementById('pageLimitSelect').value)
            };
            
            appData.preferences = newPreferences;
            appData.itemsPerPage = newPreferences.pageLimit;
            
            saveData();
            showNotification('Pr√©f√©rences enregistr√©es', 'success');
        }

        // Fonctions globales
        window.editTransaction = function(id) {
            const trans = appData.transactions.find(t => t.id === id);
            if (trans) {
                appData.editingTransactionId = id;
                document.getElementById('modalTransactionTitle').textContent = 'Modifier Transaction';
                
                // Remplir le formulaire
                document.getElementById('transactionDate').value = trans.date;
                document.getElementById('transactionType').value = trans.type;
                document.getElementById('transactionAmount').value = trans.amount;
                document.getElementById('transactionDescription').value = trans.description;
                
                updateCategoryOptions();
                
                // D√©finir la cat√©gorie apr√®s un d√©lai
                setTimeout(() => {
                    document.getElementById('transactionCategory').value = trans.category;
                }, 100);
                
                document.getElementById('transactionModal').classList.add('active');
            }
        };

        window.deleteTransaction = function(id) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer cette transaction ?')) {
                appData.transactions = appData.transactions.filter(t => t.id !== id);
                saveData();
                loadTransactions();
                showNotification('Transaction supprim√©e', 'success');
            }
        };

        window.editCategory = function(type, oldCat) {
            const newCat = prompt('Nouveau nom pour la cat√©gorie :', oldCat);
            if (newCat && newCat.trim() && newCat !== oldCat) {
                if (type === 'income') {
                    const index = appData.categories.income.indexOf(oldCat);
                    if (index !== -1) {
                        appData.categories.income[index] = newCat;
                        // Mettre √† jour les transactions
                        appData.transactions.forEach(t => {
                            if (t.category === oldCat && t.type === 'income') {
                                t.category = newCat;
                            }
                        });
                    }
                } else {
                    const index = appData.categories.expense.indexOf(oldCat);
                    if (index !== -1) {
                        appData.categories.expense[index] = newCat;
                        // Mettre √† jour les transactions
                        appData.transactions.forEach(t => {
                            if (t.category === oldCat && t.type === 'expense') {
                                t.category = newCat;
                            }
                        });
                    }
                }
                saveData();
                loadCategories();
                showNotification('Cat√©gorie modifi√©e', 'success');
            }
        };

        window.deleteCategory = function(type, cat) {
            // Compter les transactions utilisant cette cat√©gorie
            const transactionCount = appData.transactions.filter(t => t.category === cat && 
                t.type === (type === 'income' ? 'income' : 'expense')).length;
            
            let message = `√ätes-vous s√ªr de vouloir supprimer la cat√©gorie "${cat}" ?`;
            if (transactionCount > 0) {
                message += `\n\nAttention : ${transactionCount} transaction(s) utilise(nt) cette cat√©gorie. Elles seront affect√©es.`;
            }
            
            if (confirm(message)) {
                if (type === 'income') {
                    appData.categories.income = appData.categories.income.filter(c => c !== cat);
                } else {
                    appData.categories.expense = appData.categories.expense.filter(c => c !== cat);
                }
                saveData();
                loadCategories();
                showNotification('Cat√©gorie supprim√©e', 'success');
            }
        };

        window.editUser = function(id) {
            const user = appData.users.find(u => u.id === id);
            if (user) {
                appData.editingUserId = id;
                document.getElementById('modalUserTitle').textContent = 'Modifier Gestionnaire';
                
                // Remplir le formulaire
                document.getElementById('userLastName').value = user.lastName;
                document.getElementById('userFirstName').value = user.firstName;
                document.getElementById('userEmail').value = user.email;
                document.getElementById('userRole').value = user.role;
                document.getElementById('userPassword').value = user.password;
                
                document.getElementById('userModal').classList.add('active');
            }
        };

        window.toggleUserStatus = function(id) {
            const user = appData.users.find(u => u.id === id);
            if (user) {
                const newStatus = !user.isActive;
                if (confirm(`√ätes-vous s√ªr de vouloir ${newStatus ? 'activer' : 'd√©sactiver'} l'utilisateur ${user.firstName} ${user.lastName} ?`)) {
                    user.isActive = newStatus;
                    saveData();
                    loadUsers();
                    showNotification(`Utilisateur ${newStatus ? 'activ√©' : 'd√©sactiv√©'}`, 'success');
                }
            }
        };

        window.deleteUser = function(id) {
            const user = appData.users.find(u => u.id === id);
            if (user) {
                if (confirm(`√ätes-vous s√ªr de vouloir supprimer l'utilisateur ${user.firstName} ${user.lastName} ?\n\nCette action ne peut pas √™tre annul√©e.`)) {
                    appData.users = appData.users.filter(u => u.id !== id);
                    saveData();
                    loadUsers();
                    showNotification('Utilisateur supprim√©', 'success');
                }
            }
        };

        function formatCurrency(amount) {
            const formatter = new Intl.NumberFormat('fr-FR', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
            
            const formattedAmount = formatter.format(amount);
            
            switch (appData.preferences.currency) {
                case 'EUR':
                    return `‚Ç¨${formattedAmount}`;
                case 'USD':
                    return `$${formattedAmount}`;
                default:
                    return `${formattedAmount} FCFA`;
            }
        }

        function showNotification(message, type) {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.className = `notification notification-${type}`;
            notif.classList.add('show');
            
            setTimeout(() => {
                notif.classList.remove('show');
            }, 3000);
        }

        // Rendre saveUser accessible globalement pour le bouton du modal
        document.getElementById('saveUserBtn').addEventListener('click', saveUser);
    </script>
</body>
</html>
